!function(t){var e={};function s(a){if(e[a])return e[a].exports;var i=e[a]={i:a,l:!1,exports:{}};return t[a].call(i.exports,i,i.exports,s),i.l=!0,i.exports}s.m=t,s.c=e,s.d=function(t,e,a){s.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:a})},s.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s.t=function(t,e){if(1&e&&(t=s(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(s.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)s.d(a,i,function(e){return t[e]}.bind(null,i));return a},s.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return s.d(e,"a",e),e},s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},s.p="",s(s.s=8)}([function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.appSettings=e.LangHelper=e.stringResources=e.Language=void 0,e.UT=function(t,e="",s=""){t=d[t]||t;const a=u.get("uiLanguage")!=i.EN?p.get(t):"",r=(a||t).replace("XXX",e).replace("YYY",s);return $("<i/>").addClass("UT").attr("en-text",t).attr("lang",a?u.get("uiLanguage"):i.EN).text(r)},e.PT=function(t){return $("<i/>").addClass("PT").attr("si-text",t).attr("script",u.get("paliScript")).text(a.TextProcessor.convert(t,u.get("paliScript")))},e.PT_REFRESH=function(t){$("i.PT",t).each((t,e)=>{let s=$(e).attr("si-text");s=a.TextProcessor.convert(s,u.get("paliScript")),$(e).text(s).attr("script",u.get("paliScript"))})};var a=s(1);const i=e.Language=Object.freeze({SI:"si",EN:"en",CHINESE:"ch",HI:"hi",INDO:"in",BUR:"my",THAI:"th"}),r=new Map([[i.SI,["Sinhala","‡∑É‡∑í‡∂Ç‡∑Ñ‡∂Ω",[],{f:"sl_flag.png",t:!0}]],[i.EN,["English","English",[],{f:"uk_flag.png",t:!0}]],[i.CHINESE,["Chinese","Ê±âËØ≠",[],{f:"china_flag.png"}]],[i.HI,["Hindi","‡§π‡§ø‡§®‡•ç‡§¶‡•Ä",[],{f:"in_flag.png"}]],[i.INDO,["Indonesian","baÀàhasa indoneÀàsia",[],{f:"indonesia_flag.png"}]],[i.BUR,["Burmese","·Äô·Äº·Äî·Ä∫·Äô·Ä¨·Äò·Ä¨·Äû·Ä¨",[],{f:"my_flag.png"}]],[i.THAI,["Thai","‡∏†‡∏≤‡∏©‡∏≤‡πÑ‡∏ó‡∏¢",[],{f:"th_flag.png"}]]]),n=new Map([["none",["Do Not Show",'<i class="far fa-eye-slash"/>']],["click",["Show On Click",'<i class="fal fa-mouse-pointer"></i>']],["hover",["Show On Hover",'<i class="far fa-bullseye"></i>']]]),o=new Map([["none",["Do Not Show",""]],["click",["Show On Click",'<n><i class="far fa-asterisk"></i></n>']],["inline",["Show Inline","<n>[‚Ä¶]</n>"]]]),c=new Map([["none",["Do Not Show",""]],["click",["Show On Click",'<pd class="T">¬∂</pd>']],["short",["Short Name",'<pd class="T">[T 1.34]</pd>']],["full",["Full Name",'<pd class="T">[Thai 3.41]</pd>']]]),l=new Map([["12",["Smallest",'<i style="font-size: 12px">Aa</i>']],["14",["Smaller",'<i style="font-size: 14px">Aa</i>']],["16",["Medium",'<i style="font-size: 16px">Aa</i>']],["19",["Larger",'<i style="font-size: 18px">Aa</i>']],["22",["Largest",'<i style="font-size: 20px">Aa</i>']],["26",["XL",'<i style="font-size: 22px">Aa</i>']],["32",["XXL",'<i style="font-size: 24px">Aa</i>']]]),h={footnoteFormat:"inline",pageTagFormat:"click",textSize:"16",uiLanguage:i.EN,tabViewFormat:"tabbed",ftsSelected:!1,dictList:["en-buddhadatta"],dictLaunchMethod:"click"};const d=e.stringResources={"copy-link":"Link has been copied to the clipboard. You can now paste it.","enter-more-characters":"Please enter minimun XXX characters to start the searching.","fts-search-term-one-char":"Each of the search terms must have at least one character.","fts-too-many-results-found":"XXX results found. First YYY results shown.","fts-range-word-distance":"Allowed Range for word distance 1 - 99.","too-many-results-found":"Too many results found. First XXX of results shown.","number-of-results-found":"XXX results found for your search term.","no-results-found":"Search term XXX did not return any results.","number-of-bookmarks":"There are XXX bookmarks matching your filter.","no-bookmarks":"You have no bookmarks saved. Click the star icon to save to bookmarks."};let p=new Map;class g{static async extractLanguageStrings(t){await g.loadTranslation(t);const e=new Map(data_trans);$("i.UT").each((t,s)=>{const a=$(s).attr("lang")==i.EN?$(s).text().trim():$(s).attr("en-text");e.has(a)||e.set(a,"")}),Object.entries(d).forEach(([t,s])=>{e.has(s)||e.set(s,"")});const s=[];e.forEach((t,e)=>s.push(e,t)),console.log(s.join("\r\n"))}static async loadTranslation(t){const e=`./scripts/translations/${t}_trans.js`;await $.getScript(e,function(t,s,a){console.log(`Translation script with data length ${t.length} was loaded from file ${e}. \n                Status '${s}:${a.status}`)})}static async changeTranslation(t){if(console.log(`changing UI language to ${t}`),t==i.EN)return p.clear(),void $("i.UT").each((t,e)=>$(e).text($(e).attr("en-text")||$(e).text().trim())).attr("lang",t);await g.loadTranslation(t),p=new Map(data_trans.filter(t=>t[1])),$("i.UT").each((e,s)=>{const a=$(s).attr("en-text")||$(s).text().trim();a||console.error(`UT found with empty en-text ${$(s)}`),p.has(a)?$(s).attr("en-text",a).attr("lang",t).text(p.get(a)):$(s).attr("lang",i.EN)})}}e.LangHelper=g;const u=e.appSettings=new class{constructor(){this.settings={},this.loadFromStorage(),this.paliScriptList=a.paliScriptInfo,this.uiLanguageList=r,this.dictLaunchList=n,this.footnoteFormatList=o,this.pageTagFormatList=c,this.textSizeList=l}set(t,e){return this.settings[t]=e,localStorage.setItem("settings",JSON.stringify(this.settings)),e}get(t){return this.settings[t]}loadFromStorage(){const t=localStorage.getItem("settings");this.settings=t?JSON.parse(t):{},this.settings.paliScript?this.paliScriptSource="storage":(this.paliScriptSource="default",this.settings.paliScript=a.Script.SI),this.loadDefaults(),console.log(this.settings)}loadDefaults(){Object.keys(h).forEach(t=>{this.settings[t]||(this.settings[t]=h[t])})}}},function(t,e,s){"use strict";s.r(e),s.d(e,"TextProcessor",function(){return L}),s.d(e,"Script",function(){return a}),s.d(e,"paliScriptInfo",function(){return i}),s.d(e,"getScriptForCode",function(){return r});const a=Object.freeze({SI:"si",HI:"hi",RO:"ro",THAI:"th",LAOS:"lo",MY:"my",KM:"km",BENG:"be",GURM:"gm",THAM:"tt",GUJA:"gj",TELU:"te",KANN:"ka",MALA:"mm",BRAH:"br",TIBT:"tb",CYRL:"cy"}),i=new Map([[a.SI,["Sinhala","‡∑É‡∑í‡∂Ç‡∑Ñ‡∂Ω",[[3456,3583]],{f:"sl_flag.png"}]],[a.HI,["Devanagari","‡§π‡§ø‡§®‡•ç‡§¶‡•Ä",[[2304,2431]],{f:"in_flag.png"}]],[a.RO,["Roman","Roman",[[0,383],[7680,7935]],{f:"uk_flag.png"}]],[a.THAI,["Thai","‡πÑ‡∏ó‡∏¢",[[3584,3711]],{f:"th_flag.png"}]],[a.LAOS,["Laos","‡∫•‡∫≤‡∫ß",[[3712,3839]],{f:"laos_flag.png"}]],[a.MY,["Myanmar","·Äó·Äô·Ä¨·ÄÖ·Ä¨",[[4096,4223]],{f:"my_flag.png"}]],[a.KM,["Khmer","·ûó·û∂·ûü·û∂·ûÅ·üí·ûò·üÇ·ûö",[[6016,6143]],{f:"kh_flag.png"}]],[a.BENG,["Bengali","‡¶¨‡¶æ‡¶Ç‡¶≤‡¶æ",[[2432,2559]],{f:"bangla_flag.png"}]],[a.GURM,["Gurmukhi","‡®ó‡©Å‡®∞‡®Æ‡©Å‡®ñ‡©Ä",[[2560,2687]],{}]],[a.THAM,["Tai Tham","Tai Tham LN",[[6688,6831]],{c:"beta-script"}]],[a.GUJA,["Gujarati","‡™ó‡´Å‡™ú‡™∞‡™æ‡™§‡´Ä",[[2688,2815]],{}]],[a.TELU,["Telugu","‡∞§‡±Ü‡∞≤‡±Å‡∞ó‡±Å",[[3072,3199]],{}]],[a.KANN,["Kannada","‡≤ï‡≤®‡≥ç‡≤®‡≤°",[[3200,3327]],{}]],[a.MALA,["Malayalam","‡¥Æ‡¥≤‡¥Ø‡¥æ‡¥≥‡¥Ç",[[3328,3455]],{}]],[a.BRAH,["Brahmi","BrƒÅhmƒ´",[[55300,55300],[56320,56447]],{}]],[a.TIBT,["Tibetan","‡Ωñ‡Ωº‡Ωë‡ºã‡Ω¶‡æê‡Ωë‡ºç",[[3840,4095]],{f:"tibet_flag.png",c:"larger"}]],[a.CYRL,["Cyrillic","–∫–∏—Ä–∏–ª–ª–∏—Ü–∞",[[1024,1279],[768,879]],{f:"russia_flag.png"}]]]);function r(t){for(let e of i)for(let s of e[1][2])if(t>=s[0]&&t<=s[1])return e[0];return-1}const n={[a.SI]:0,[a.HI]:1,[a.RO]:2,[a.THAI]:3,[a.LAOS]:4,[a.MY]:5,[a.KM]:6,[a.BENG]:7,[a.GURM]:8,[a.THAM]:9,[a.GUJA]:10,[a.TELU]:11,[a.KANN]:12,[a.MALA]:13,[a.BRAH]:14,[a.TIBT]:15,[a.CYRL]:16},o=[["‡∂Ö","‡§Ö","a","‡∏≠","‡∫≠","·Ä°","·û¢","‡¶Ö","‡®Ö","·©ã","‡™Ö","‡∞Ö","‡≤Ö","‡¥Ö","ëÄÖ","‡Ω®","–∞"],["‡∂Ü","‡§Ü","ƒÅ","‡∏≠‡∏≤","‡∫≠‡∫≤","·Ä°·Ä¨","·û¢·û∂","‡¶Ü","‡®Ü","·©å","‡™Ü","‡∞Ü","‡≤Ü","‡¥Ü","ëÄÜ","‡Ω®‡Ω±","–∞–∞"],["‡∂â","‡§á","i","‡∏≠‡∏¥","‡∫≠‡∫¥","·Ä£","·û•","‡¶á","‡®á","·©ç","‡™á","‡∞á","‡≤á","‡¥á","ëÄá","‡Ω®‡Ω≤","–∏"],["‡∂ä","‡§à","ƒ´","‡∏≠‡∏µ","‡∫≠‡∫µ","·Ä§","·û¶","‡¶à","‡®à","·©é","‡™à","‡∞à","‡≤à","‡¥à","ëÄà","‡Ω®‡Ω±‡Ω≤","–∏–π"],["‡∂ã","‡§â","u","‡∏≠‡∏∏","‡∫≠‡∫∏","·Ä•","·ûß","‡¶â","‡®â","·©è","‡™â","‡∞â","‡≤â","‡¥â","ëÄâ","‡Ω®‡Ω¥","—É"],["‡∂å","‡§ä","≈´","‡∏≠‡∏π","‡∫≠‡∫π","·Ä¶","·û©","‡¶ä","‡®ä","·©ê","‡™ä","‡∞ä","‡≤ä","‡¥ä","ëÄä","‡Ω®‡Ω±‡Ω¥","—É—É"],["‡∂ë","‡§è","e","‡πÄ‡∏≠","‡ªÄ‡∫≠","·Äß","·ûØ","‡¶è","‡®è","·©ë","‡™è","‡∞è","‡≤è","‡¥è","ëÄè","‡Ω®‡Ω∫","–∑"],["‡∂î","‡§ì","o","‡πÇ‡∏≠","‡ªÇ‡∫≠","·Ä©","·û±","‡¶ì","‡®ì","·©í","‡™ì","‡∞ì","‡≤ì","‡¥ì","ëÄë","‡Ω®‡Ωº","–æ"],["‡∂Ç","‡§Ç","·πÅ","‡πç","‡ªç","·Ä∂","·üÜ","‡¶Ç","‡®Ç","·©¥","‡™Ç","‡∞Ç","‡≤Ç","‡¥Ç","ëÄÅ","‡Ωæ","–ºÃ£"],["‡∂É","‡§É","·∏•","‡∏∞","‡∫∞","·Ä∏","·üá","‡¶É","‡®É","·©°","‡™É","‡∞É","‡≤É","‡¥É","ëÄÇ","‡Ωø","—ÖÃ£"],["‡∑ä","‡•ç","","‡∏∫","‡∫∫","·Äπ","·üí","‡ßç","‡©ç","·©†","‡´ç","‡±ç","‡≥ç","‡µç","ëÅÜ","‡æÑ",""],["0","‡•¶","0","‡πê","‡ªê","·ÅÄ","·ü†","‡ß¶","‡©¶","·™ê","‡´¶","‡±¶","‡≥¶","‡µ¶","ëÅ¶","‡º†","0"],["1","‡•ß","1","‡πë","‡ªë","·ÅÅ","·ü°","‡ßß","‡©ß","·™ë","‡´ß","‡±ß","‡≥ß","‡µß","ëÅß","‡º°","1"],["2","‡•®","2","‡πí","‡ªí","·ÅÇ","·ü¢","‡ß®","‡©®","·™í","‡´®","‡±®","‡≥®","‡µ®","ëÅ®","‡º¢","2"],["3","‡•©","3","‡πì","‡ªì","·ÅÉ","·ü£","‡ß©","‡©©","·™ì","‡´©","‡±©","‡≥©","‡µ©","ëÅ©","‡º£","3"],["4","‡•™","4","‡πî","‡ªî","·ÅÑ","·ü§","‡ß™","‡©™","·™î","‡´™","‡±™","‡≥™","‡µ™","ëÅ™","‡º§","4"],["5","‡•´","5","‡πï","‡ªï","·ÅÖ","·ü•","‡ß´","‡©´","·™ï","‡´´","‡±´","‡≥´","‡µ´","ëÅ´","‡º•","5"],["6","‡•¨","6","‡πñ","‡ªñ","·ÅÜ","·ü¶","‡ß¨","‡©¨","·™ñ","‡´¨","‡±¨","‡≥¨","‡µ¨","ëÅ¨","‡º¶","6"],["7","‡•≠","7","‡πó","‡ªó","·Åá","·üß","‡ß≠","‡©≠","·™ó","‡´≠","‡±≠","‡≥≠","‡µ≠","ëÅ≠","‡ºß","7"],["8","‡•Æ","8","‡πò","‡ªò","·Åà","·ü®","‡ßÆ","‡©Æ","·™ò","‡´Æ","‡±Æ","‡≥Æ","‡µÆ","ëÅÆ","‡º®","8"],["9","‡•Ø","9","‡πô","‡ªô","·Åâ","·ü©","‡ßØ","‡©Ø","·™ô","‡´Ø","‡±Ø","‡≥Ø","‡µØ","ëÅØ","‡º©","9"]],c=[["‡∂ö","‡§ï","k","‡∏Å","‡∫Å","·ÄÄ","·ûÄ","‡¶ï","‡®ï","·®†","‡™ï","‡∞ï","‡≤ï","‡¥ï","ëÄì","‡ΩÄ","–≥"],["‡∂õ","‡§ñ","kh","‡∏Ç","‡∫Ç","·ÄÅ","·ûÅ","‡¶ñ","‡®ñ","·®°","‡™ñ","‡∞ñ","‡≤ñ","‡¥ñ","ëÄî","‡ΩÅ","–∫"],["‡∂ú","‡§ó","g","‡∏Ñ","‡∫Ñ","·ÄÇ","·ûÇ","‡¶ó","‡®ó","·®£","‡™ó","‡∞ó","‡≤ó","‡¥ó","ëÄï","‡ΩÇ","–≥Ãá"],["‡∂ù","‡§ò","gh","‡∏Ü","‡∫Ü","·ÄÉ","·ûÉ","‡¶ò","‡®ò","·®•","‡™ò","‡∞ò","‡≤ò","‡¥ò","ëÄñ","‡ΩÉ","–≥—Ö"],["‡∂û","‡§ô","·πÖ","‡∏á","‡∫á","·ÄÑ","·ûÑ","‡¶ô","‡®ô","·®¶","‡™ô","‡∞ô","‡≤ô","‡¥ô","ëÄó","‡ΩÑ","–ΩÃá"],["‡∂†","‡§ö","c","‡∏à","‡∫à","·ÄÖ","·ûÖ","‡¶ö","‡®ö","·®ß","‡™ö","‡∞ö","‡≤ö","‡¥ö","ëÄò","‡Ωô","–∂"],["‡∂°","‡§õ","ch","‡∏â","‡∫â","·ÄÜ","·ûÜ","‡¶õ","‡®õ","·®®","‡™õ","‡∞õ","‡≤õ","‡¥õ","ëÄô","‡Ωö","—á"],["‡∂¢","‡§ú","j","‡∏ä","‡∫ä","·Äá","·ûá","‡¶ú","‡®ú","·®©","‡™ú","‡∞ú","‡≤ú","‡¥ú","ëÄö","‡Ωõ","–∂Ãá"],["‡∂£","‡§ù","jh","‡∏å","‡∫å","·Äà","·ûà","‡¶ù","‡®ù","·®´","‡™ù","‡∞ù","‡≤ù","‡¥ù","ëÄõ","‡Ωú","–∂—Ö"],["‡∂§","‡§û","√±","‡∏ç","‡∫é","·Äâ","·ûâ","‡¶û","‡®û","·®¨","‡™û","‡∞û","‡≤û","‡¥û","ëÄú","‡Ωâ","–ΩÃÉ"],["‡∂ß","‡§ü","·π≠","‡∏è","‡∫è","·Äã","·ûä","‡¶ü","‡®ü","·®≠","‡™ü","‡∞ü","‡≤ü","‡¥ü","ëÄù","‡Ωä","–¥"],["‡∂®","‡§†","·π≠h","‡∏ê","‡∫ê","·Äå","·ûã","‡¶†","‡®†","·®Æ","‡™†","‡∞†","‡≤†","‡¥†","ëÄû","‡Ωã","—Ç"],["‡∂©","‡§°","·∏ç","‡∏ë","‡∫ë","·Äç","·ûå","‡¶°","‡®°","·®Ø","‡™°","‡∞°","‡≤°","‡¥°","ëÄü","‡Ωå","–¥Ã£"],["‡∂™","‡§¢","·∏çh","‡∏í","‡∫í","·Äé","·ûç","‡¶¢","‡®¢","·®∞","‡™¢","‡∞¢","‡≤¢","‡¥¢","ëÄ†","‡Ωç","–¥—Ö"],["‡∂´","‡§£","·πá","‡∏ì","‡∫ì","·Äè","·ûé","‡¶£","‡®£","·®±","‡™£","‡∞£","‡≤£","‡¥£","ëÄ°","‡Ωé","–ΩÃ£"],["‡∂≠","‡§§","t","‡∏ï","‡∫ï","·Äê","·ûè","‡¶§","‡®§","·®≤","‡™§","‡∞§","‡≤§","‡¥§","ëÄ¢","‡Ωè","–¥Ãá"],["‡∂Æ","‡§•","th","‡∏ñ","‡∫ñ","·Äë","·ûê","‡¶•","‡®•","·®≥","‡™•","‡∞•","‡≤•","‡¥•","ëÄ£","‡Ωê","—ÇÃá"],["‡∂Ø","‡§¶","d","‡∏ó","‡∫ó","·Äí","·ûë","‡¶¶","‡®¶","·®¥","‡™¶","‡∞¶","‡≤¶","‡¥¶","ëÄ§","‡Ωë","–¥ÃáÃ£"],["‡∂∞","‡§ß","dh","‡∏ò","‡∫ò","·Äì","·ûí","‡¶ß","‡®ß","·®µ","‡™ß","‡∞ß","‡≤ß","‡¥ß","ëÄ•","‡Ωí","–¥Ãá—Ö"],["‡∂±","‡§®","n","‡∏ô","‡∫ô","·Äî","·ûì","‡¶®","‡®®","·®∂","‡™®","‡∞®","‡≤®","‡¥®","ëÄ¶","‡Ωì","–Ω"],["‡∂¥","‡§™","p","‡∏õ","‡∫õ","·Äï","·ûî","‡¶™","‡®™","·®∏","‡™™","‡∞™","‡≤™","‡¥™","ëÄß","‡Ωî","–±"],["‡∂µ","‡§´","ph","‡∏ú","‡∫ú","·Äñ","·ûï","‡¶´","‡®´","·®π","‡™´","‡∞´","‡≤´","‡¥´","ëÄ®","‡Ωï","–ø"],["‡∂∂","‡§¨","b","‡∏û","‡∫û","·Äó","·ûñ","‡¶¨","‡®¨","·®ª","‡™¨","‡∞¨","‡≤¨","‡¥¨","ëÄ©","‡Ωñ","–±Ã£"],["‡∂∑","‡§≠","bh","‡∏†","‡∫†","·Äò","·ûó","‡¶≠","‡®≠","·®Ω","‡™≠","‡∞≠","‡≤≠","‡¥≠","ëÄ™","‡Ωó","–±—Ö"],["‡∂∏","‡§Æ","m","‡∏°","‡∫°","·Äô","·ûò","‡¶Æ","‡®Æ","·®æ","‡™Æ","‡∞Æ","‡≤Æ","‡¥Æ","ëÄ´","‡Ωò","–º"],["‡∂∫","‡§Ø","y","‡∏¢","‡∫ç","·Äö","·ûô","‡¶Ø","‡®Ø","·®ø","‡™Ø","‡∞Ø","‡≤Ø","‡¥Ø","ëÄ¨","‡Ω°","—è"],["‡∂ª","‡§∞","r","‡∏£","‡∫£","·Äõ","·ûö","‡¶∞","‡®∞","·©Å","‡™∞","‡∞∞","‡≤∞","‡¥∞","ëÄ≠","‡Ω¢","—Ä"],["‡∂Ω","‡§≤","l","‡∏•","‡∫•","·Äú","·ûõ","‡¶≤","‡®≤","·©É","‡™≤","‡∞≤","‡≤≤","‡¥≤","ëÄÆ","‡Ω£","–ª"],["‡∑Ö","‡§≥","·∏∑","‡∏¨","‡∫¨","·Ä†","·û°","‡¶≤‡¶º","‡®≥","·©ä","‡™≥","‡∞≥","‡≤≥","‡¥≥","ëÄ¥","‡Ω£‡ºπ","–ªÃ£"],["‡∑Ä","‡§µ","v","‡∏ß","‡∫ß","·Äù","·ûú","‡ß∞","‡®µ","·©Ö","‡™µ","‡∞µ","‡≤µ","‡¥µ","ëÄØ","‡Ωù","–≤"],["‡∑É","‡§∏","s","‡∏™","‡∫™","·Äû","·ûü","‡¶∏","‡®∏","·©à","‡™∏","‡∞∏","‡≤∏","‡¥∏","ëÄ≤","‡Ω¶","—Å"],["‡∑Ñ","‡§π","h","‡∏´","‡∫´","·Äü","·û†","‡¶π","‡®π","·©â","‡™π","‡∞π","‡≤π","‡¥π","ëÄ≥","‡Ωß","—Ö"]],l=[["‡∑è","‡§æ","ƒÅ","‡∏≤","‡∫≤","·Ä¨","·û∂","‡¶æ","‡®æ","·©£","‡™æ","‡∞æ","‡≤æ","‡¥æ","ëÄ∏","‡Ω±","–∞–∞"],["‡∑í","‡§ø","i","‡∏¥","‡∫¥","·Ä≠","·û∑","‡¶ø","‡®ø","·©•","‡™ø","‡∞ø","‡≤ø","‡¥ø","ëÄ∫","‡Ω≤","–∏"],["‡∑ì","‡•Ä","ƒ´","‡∏µ","‡∫µ","·ÄÆ","·û∏","‡ßÄ","‡©Ä","·©¶","‡´Ä","‡±Ä","‡≥Ä","‡µÄ","ëÄª","‡Ω±‡Ω≤","–∏–π"],["‡∑î","‡•Å","u","‡∏∏","‡∫∏","·ÄØ","·ûª","‡ßÅ","‡©Å","·©©","‡´Å","‡±Å","‡≥Å","‡µÅ","ëÄº","‡Ω¥","—É"],["‡∑ñ","‡•Ç","≈´","‡∏π","‡∫π","·Ä∞","·ûº","‡ßÇ","‡©Ç","·©™","‡´Ç","‡±Ç","‡≥Ç","‡µÇ","ëÄΩ","‡Ω±‡Ω¥","—É—É"],["‡∑ô","‡•á","e","‡πÄ","‡ªÄ","·Ä±","·üÅ","‡ßá","‡©á","·©Æ","‡´á","‡±á","‡≥á","‡µá","ëÅÇ","‡Ω∫","–∑"],["‡∑ú","‡•ã","o","‡πÇ","‡ªÇ","·Ä±·Ä¨","·üÑ","‡ßã","‡©ã","·©Æ·©£","‡´ã","‡±ã","‡≥ã","‡µã","ëÅÑ","‡Ωº","–æ"]];function h(t,e,s=""){return"cen"==s?t=t.replace(/‡••/g,""):s.startsWith("ga")&&(t=(t=t.replace(/‡•§/g,";")).replace(/‡••/g,".")),t=(t=(t=(t=t.replace(/‡•∞‚Ä¶/g,"‚Ä¶")).replace(/‡•∞/g,"¬∑")).replace(/[‡•§‡••]/g,".")).replace(/\s([\s,!;\?\.])/g,"$1")}function d(t,e,s=""){if(e==a.THAI)return t.replace(/([‡∏Å-‡∏Æ])([‡πÄ‡πÇ])/g,"$2$1");if(e==a.LAOS)return t.replace(/([‡∫Å-‡∫Æ])([‡ªÄ‡ªÇ])/g,"$2$1");throw new Error(`Unsupported script ${e} for swap_e_o method.`)}function p(t,e){if(e==a.THAI||e==a.LAOS)return t.replace(/([‡∑ô‡∑ú])([‡∂ö-‡∑Ü])/g,"$2$1");throw new Error(`Unsupported script ${e} for un_swap_e_o method.`)}function g(t){return t.replace(/\u200C|\u200D/g,"")}const u=[],f={[a.SI]:[function(t,e,s=""){return t.replace(/\u0DCA([\u0DBA\u0DBB])/g,"‡∑ä‚Äç$1")},h],[a.RO]:[h,function(t,e,s=""){return(t=(t=t.replace(/^((?:<w>)?\S)/g,(t,e)=>e.toUpperCase())).replace(/([\.\?]\s(?:<w>)?)(\S)/g,(t,e,s)=>`${e}${s.toUpperCase()}`)).replace(/([\u201C‚Äò](?:<w>)?)(\S)/g,(t,e,s)=>`${e}${s.toUpperCase()}`)}],[a.THAI]:[d,h],[a.LAOS]:[d,h],[a.MY]:[function(t,e,s=""){return(t=(t=(t=(t=(t=(t=(t=(t=(t=t.replace(/[,;]/g,"·Åä")).replace(/[\u2026\u0964\u0965]+/g,"·Åã")).replace(/·Äâ\u1039·Äâ/g,"·Ää")).replace(/·Äû\u1039·Äû/g,"·Äø")).replace(/·ÄÑ·Äπ([·ÄÄ-·Ä†])/g,"·ÄÑ·Ä∫·Äπ$1")).replace(/·Äπ·Äö/g,"·Äª")).replace(/·Äπ·Äõ/g,"·Äº")).replace(/·Äπ·Äù/g,"·ÄΩ")).replace(/·Äπ·Äü/g,"·Äæ")).replace(/([·ÄÅ·ÄÇ·Äí·Äï·Äù](:?·Äπ[·ÄÄ-·Ä†])?·Ä±?)·Ä¨/g,"$1·Ä´")},h],[a.KM]:[h],[a.THAM]:[function(t){return(t=(t=(t=t.replace(/\u1A60\u1A41/g,"·©ï")).replace(/\u1A48\u1A60\u1A48/g,"·©î")).replace(/‡•§/g,"·™®")).replace(/‡••/g,"·™©")}],[a.GUJA]:[h],[a.TELU]:[h],[a.MALA]:[h],[a.BRAH]:[function(t){return(t=(t=t.replace(/‡•§/g,"ëÅá")).replace(/‡••/g,"ëÅà")).replace(/‚Äì/g,"ëÅã")},h],[a.TIBT]:[function(t){t=(t=t.replace(/‡•§/g,"‡ºç")).replace(/‡••/g,"‡ºé");for(let e=0;e<=39;e++)t=t.replace(new RegExp(String.fromCharCode(3972,3904+e),"g"),String.fromCharCode(3984+e));return(t=(t=(t=(t=t.replace(/\u0F61\u0FB1/g,"‡Ω°‡æª")).replace(/\u0F5D\u0FAD/g,"‡Ωù‡æ∫")).replace(/\u0F5B\u0FAC/g,"‡Ωõ‡æÑ‡Ωú")).replace(/\u0F61\u0FB7/g,"‡Ω°‡æÑ‡Ωß")).replace(/\u0F5D\u0FB7/g,"‡Ωù‡æÑ‡Ωß")}],[a.CYRL]:[h]},m=[],T={[a.SI]:[g],[a.HI]:[g],[a.RO]:[t=>t.toLowerCase()],[a.MY]:[function(t){return(t=(t=(t=(t=(t=(t=(t=(t=(t=t.replace(/\u102B/g,"·Ä¨")).replace(/·Äæ/g,"·Äπ·Äü")).replace(/·ÄΩ/g,"·Äπ·Äù")).replace(/·Äº/g,"·Äπ·Äõ")).replace(/·Äª/g,"·Äπ·Äö")).replace(/\u103A/g,"")).replace(/·Äø/g,"·Äû·Äπ·Äû")).replace(/·Ää/g,"·Äâ·Äπ·Äâ")).replace(/·Åä/g,",")).replace(/·Åã/g,".")}],[a.TIBT]:[function(t){return t}]};function $(t,e,s=!0){let a=[[],[],[]];return c.concat(o,s?l:[]).forEach(s=>{s[t]&&a[s[t].length-1].push([s[t],s[e]])}),a.filter(t=>t.length).map(t=>[t[0][0].length,new Map(t)]).reverse()}function S(t,e){let s=new Array,a=0;for(;a<t.length;){let i=!1;for(let[r,n]of e){const e=t.substr(a,r);if(n.has(e)){s.push(n.get(e)),i=!0,a+=r;break}}i||(s.push(t.charAt(a)),a++)}return s.join("")}function b(t,e){const s=e==a.CYRL?"–∞":"a";return(t=(t=t.replace(new RegExp(`([‡∂ö-‡∑Ü])([^‡∑è-‡∑ü‡∑ä${s}])`,"g"),`$1${s}$2`)).replace(new RegExp(`([‡∂ö-‡∑Ü])([^‡∑è-‡∑ü‡∑ä${s}])`,"g"),`$1${s}$2`)).replace(/([‡∂ö-‡∑Ü])$/g,`$1${s}`)}const v={"‡∂Ö":"","‡∂Ü":"‡∑è","‡∂â":"‡∑í","‡∂ä":"‡∑ì","‡∂ã":"‡∑î","‡∂å":"‡∑ñ","‡∂ë":"‡∑ô","‡∂î":"‡∑ú"};function w(t,e){return t=(t=(t=t.replace(/([‡∂ö-‡∑Ü])([^‡∂Ö‡∂Ü‡∂â‡∂ä‡∂ã‡∂å‡∂ë‡∂î])/g,"$1‡∑ä$2")).replace(/([‡∂ö-‡∑Ü])$/g,"$1‡∑ä")).replace(/([‡∂ö-‡∑Ü])([‡∂Ö‡∂Ü‡∂â‡∂ä‡∂ã‡∂å‡∂ë‡∂î])/g,(t,e,s)=>e+v[s])}const k=[P],C={[a.SI]:[],[a.RO]:[b,P],[a.CYRL]:[b,P]},y=[I],x={[a.SI]:[],[a.RO]:[E,t=>t.replace(/·πÉ/g,"‡∂Ç"),w],[a.CYRL]:[E,w],[a.THAI]:[I,p],[a.LAOS]:[I,p]};function P(t,e){return S(t,$(n[a.SI],n[e]))}function I(t,e){return S(t,$(n[e],n[a.SI]))}function E(t,e){return S(t,$(n[e],n[a.SI],!1))}class L{static basicConvert(t,e){return(C[e]||k).forEach(s=>t=s(t,e)),t}static basicConvertFrom(t,e){return(x[e]||y).forEach(s=>t=s(t,e)),t}static beautify(t,e,s=""){return(f[e]||u).forEach(a=>t=a(t,e,s)),t}static convert(t,e){return t=this.basicConvert(t,e),this.beautify(t,e)}static convertFrom(t,e){return(T[e]||m).forEach(s=>t=s(t,e)),this.basicConvertFrom(t,e)}static convertFromMixed(t){t=g(t)+" ";let e=-1,s="",a="";for(let i=0;i<t.length;i++){const n=r(t.charCodeAt(i));n!=e||i==t.length-1?(console.log(`process run: "${s}", i: ${i}, script: ${e}`),a+=this.convertFrom(s,e),e=n,s=t.charAt(i)):s+=t.charAt(i)}return a}}},function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.Util=class{static copyText(t){const e=document.createElement("textarea");e.value=t,document.body.appendChild(e),e.select(),document.execCommand("copy"),document.body.removeChild(e)}static showToast(t){var e=$("#toast").html(t).fadeIn(300);setTimeout(function(){e.fadeOut()},3e3)}static getParameterByName(t,e){t=t.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var s=new RegExp("[\\?&]"+t+"=([^&#]*)").exec(location.search);return null===s?e:decodeURIComponent(s[1].replace(/\+/g," "))}static createLanguageSelectOption(t,e,s="./static/images/"){const a=$("<span/>").addClass("UT").text(e[1]).attr("lang",t),i=e[3].f?$("<img/>").attr("src",`${s}${e[3].f}`):"",r=$("<div/>").addClass("option").append(a,i).attr("value",t);return e[3].c&&r.addClass(e[3].c),r}static createDictionarySelectOption(t,e,s){const a=$("<span/>").addClass("UT").text(e[1]).attr("lang",e[0]),i=s[3].f?$("<img/>").attr("src",`./static/images/${s[3].f}`):"";return $("<div/>").addClass("check option").append(a,i).attr("value",t)}static showDialog(t,e="",s=""){const a=$("#"+t);return dialogPolyfill.registerDialog(a[0]),e&&a.empty().append(e),s&&(s.addClass("highlighted"),a.on("close",t=>s.removeClass("highlighted"))),a[0].showModal(),a}static levenshtein(t,e){let s;if(0===t.length)return e.length;if(0===e.length)return t.length;t.length>e.length&&(s=t,t=e,e=s);let a,i,r,n=t.length,o=e.length,c=Array(n);for(a=0;a<=n;a++)c[a]=a;for(a=1;a<=o;a++)for(r=a,i=1;i<=n;i++)s=c[i-1],c[i-1]=r,r=e[a-1]===t[i-1]?s:Math.min(s+1,Math.min(r+1,c[i]+1));return r}};class a{constructor(t,e,s={}){this.root=t,this.hlElem=e,this.customCss=s,this.isOpen=!1}show(t,e=$("body")){if(this.root.css("position","relative"),this.dlgDiv=$("<div/>").addClass("jdialog").append(t).appendTo(this.root).css("width",Math.min(e.width(),t.outerWidth())).css(this.customCss).click(t=>t.stopPropagation()),this.dlgDiv.offset().left+this.dlgDiv.width()>e.offset().left+e.width()){const t=e.offset().left+e.width()-(this.root.offset().left+this.root.width());this.dlgDiv.css("left","auto").css("right",-t)}return this.hlElem&&this.hlElem.addClass("highlighted"),this.isOpen=!0,this}close(){this.dlgDiv&&this.dlgDiv.remove(),this.hlElem&&this.hlElem.removeClass("highlighted"),this.isOpen=!1}}e.JDialog=a;const i=new Map;class r{static create(t,e,s,n,o){r.destroy(t);const c=new a(s,s,o),l=setTimeout(()=>c.show(n()),e);i.set(t,{jdlg:c,timer:l})}static destroy(t){if(i.has(t)){const e=i.get(t);clearTimeout(e.timer),e.jdlg&&e.jdlg.close()}}}e.JHoverDialog=r;const n=new Map([["text",["#text-view-area","#text-view-button"]],["settings",["#settings-area","#settings-button"]],["search",["#search-area",".search-bar"]],["fts",["#fts-area",".search-bar"]],["bookmarks",["#bookmarks-area","#bookmarks-button"]],["help",["#help-area",""]]]);e.vManager=new class{constructor(){this.curPane=this.prevPane="",this.registerEvents(),this.showPane("settings"),n.forEach(t=>$(t[1]).addClass("top-pane-status"))}showPane(t){"back"==t&&(t=this.prevPane),$("div.top-pane").hide(),$(".top-pane-status").removeClass("selected");const e=n.get(t);$(e[0]).show(),e[1]&&$(e[1]).addClass("selected"),this.prevPane=this.curPane,this.curPane=t}registerEvents(){$("#settings-button").click(t=>this.showPane("settings")),$("#text-view-button").click(t=>this.showPane("text")),$("#menu-toggle").mousedown(function(t){$("#menu-list").animate({height:"toggle"},200),t.stopPropagation()}),$("#tree-toggle").mousedown(function(t){$(".pitaka-tree-container").animate({width:"toggle"},250),$(".pitaka-tree-container").toggleClass("user-opened"),t.stopPropagation()}),$("#menu-list, .pitaka-tree-container").mousedown(function(t){t.stopPropagation()}),$("body").mousedown(function(){$("#menu-list").animate({height:"hide"},250),"absolute"==$(".pitaka-tree-container").css("position")&&$(".pitaka-tree-container").animate({width:"hide"},250)}),$("dialog").click(t=>{$(t.target).is("dialog")&&t.target.close("cancelled")}),$(".help-button").click(t=>this.loadHelp(t)),$("#help-menu-item,#about-menu-item,#offline-software-menu-item").click(t=>{this.loadHelp(t),$("#menu-list").animate({height:"hide"},250)})}async loadHelp(t=null){const e=$("#help-area");if(!e.children().length){const t=await $.get("./static/help.html");e.html(t),$("i",e).each((t,e)=>$(e).addClass("fa-fw"))}if(this.showPane("help"),t){const s=$(t.currentTarget).attr("sec"),a=$(`[sec=${s}]`,e);e.scrollTop(e.scrollTop()+a.position().top)}}}},function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.PitakaTree=void 0;var a=s(0);const i="../static/json/full-tree.json";class r{constructor(t){this.root=t,this.treeJson={},this.collections=[],this.fileIdToColl={}}initialize(t){return this.appTabs=t,$.getJSON(i,t=>{this.treeJson=t,this.createCollections(this.treeJson,-1),this.root.append(this.createSubtree(this.treeJson,["m"],"tree-mul")),this.root.append(this.createSubtree(this.treeJson,["a"],"tree-att")),this.root.append(this.createSubtree(this.treeJson,["t","ta"],"tree-tik")),this.root.append(this.createSubtree(this.treeJson[3].c,["e"],"tree-e")),this.registerClick(),console.log(`Tree loaded. num collections: ${this.collections.length}, num fileIds: ${Object.keys(this.fileIdToColl).length}`)}).fail(function(t,e,s){console.error("getJSON failed, status: "+e+", error: "+s)})}createSubtree(t,e,s,i){const r=$("<ul/>").attr("id",s);return t.forEach(t=>{if(t.c){for(let s of e)if(t[s]){const i=$("<a/>").append((0,a.PT)(t[s]));$("<li/>").append(i).addClass("parent").append(this.createSubtree(t.c,e,"",s)).appendTo(r)}}else if(t[`f${i}`]){const e=$("<a/>").append((0,a.PT)(t[i])),s=t[`f${i}`];$("<li/>").append(e).attr("file-id",s).appendTo(r)}}),r}addCollection(t,e){const s=this.collections.length,a={id:s,p:e,n:[]};return Object.keys(t).forEach(e=>{if("c"!=e&&!e.startsWith("f")){const i=t[`f${e}`];i?(a.n.push([e,t[e],i]),this.fileIdToColl[i]=s):a.n.push([e,t[e]])}}),this.collections.push(a),s}createCollections(t,e){t.forEach(t=>{t.c?this.createCollections(t.c,this.addCollection(t,e)):this.addCollection(t,e)})}changeScript(){(0,a.PT_REFRESH)(this.root)}registerClick(){this.root.on("click","li > a",t=>{var e=$(t.currentTarget).parent();if(e.hasClass("parent"))this.toggleBranch(e);else if(e.attr("file-id")){const t=e.attr("file-id"),s=this.getCollection(t),a=r.filterCollection(s,t);this.appTabs.newTab(t,a[1],s)}})}getCollection(t){return this.collections[this.fileIdToColl[t]]}static filterCollection(t,e){return t.n.filter(t=>t[0]==e||t[2]==e)[0]}toggleBranch(t){t.toggleClass("active").children("ul").slideToggle("fast")}showBranch(t){t.addClass("active").children("ul").slideDown("fast")}collapse(){$("li.parent.active",this.root).removeClass("active").children("ul").slideUp("fast")}openBranch(t){this.collapse(),$(`li[file-id=${t}]`,this.root).parents("li").each((t,e)=>this.showBranch($(e)))}}e.PitakaTree=r},function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.TSH=e.TSE=e.SearchFilter=void 0;var a=s(0);e.SearchFilter=class{constructor(t,e,s,a){this.root=t,this.topParentsInfo=e,this.cbObj=a,this.filter=new Map,s.forEach(t=>this.filter.set(t,1)),this.render(),this.registerClicks()}render(){this.table=$("<table/>").addClass("filter-table").appendTo(this.root),[0,1,2].forEach(t=>{const e=$("<tr/>").attr("row",t).appendTo(this.table);[0,1,2].forEach(s=>{const a=this.topParentsInfo[3*s+t];this.renderCheckBox(a[i.id],a[i.name],t,s).appendTo(e)})});const t=this.renderCheckBox(this.topParentsInfo[9][i.id],this.topParentsInfo[9][i.name],3,0).attr("colspan",3);$("<tr/>").attr("row",3).append(t).appendTo(this.table)}renderCheckBox(t,e,s,i){return $("<td/>").html((0,a.PT)(e)).attr("row",s).attr("column",i).attr("value",t).toggleClass("checked",this.filter.has(t))}registerClicks(){this.table.on("click","td",t=>{const e=$(t.currentTarget).toggleClass("checked");e.hasClass("checked")?this.filter.set(Number(e.attr("value")),1):this.filter.delete(Number(e.attr("value"))),this.cbObj.filterChanged(Array.from(this.filter.keys()))})}};const i=e.TSE=Object.freeze({id:0,name:1,type:2,parents:3,file:4,lineInd:5});e.TSH=new class{constructor(t,e,s){this.name=t,this.dataUrl=e,this.version=s,this.data=[],this.topParentsInfo=[],this.fileToTSI=new Map}async init(){this.version==localStorage.getItem(`version_${this.name}`)&&this.getLocalData()||await this.loadUrlData(),this.data.forEach(t=>{this.fileToTSI.has(t[i.file])||"cha"!=t[i.type]||this.fileToTSI.set(t[i.file],t[i.id]),t[i.parents].length||this.topParentsInfo.push([t[i.id],t[i.name]])}),console.log(`fileToTSI map created with ${this.fileToTSI.size} entries.`),console.log(`Top Parents Info created ${this.topParentsInfo}`)}getLocalData(){const t=localStorage.getItem(this.name);return t?(this.data=JSON.parse(LZString.decompressFromUTF16(t)),console.log(`${this.name} loaded of length ${this.data.length} from local storage.`),!0):(console.log(`no data in storage for ${this.name}`),!1)}async loadUrlData(){let t;try{t=await $.getJSON(this.dataUrl)}catch(t){throw new Error(`Failed to load the ${this.name}. Please check your internet connection`)}this.data=t;const e=JSON.stringify(this.data),s=LZString.compressToUTF16(e);try{localStorage.setItem(this.name,s),console.log(`Stored data of length ${s.length} to local storage. Uncompressed length ${e.length}`),localStorage.setItem(`version_${this.name}`,this.version)}catch(t){console.error(`Failed to set ${this.name} of size ${s.length} to local storage ${t}`)}}}("title-index","./static/json/title-search-index.json","2.0")},function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.WordDisplay=e.HitHighlighter=e.LinkHandler=e.Collection=e.Note=e.PageTag=void 0;var a=s(1),i=s(0),r=s(3),n=s(2),o=s(6);const c=new Map([["T","Thai"],["M","Myanmar"],["V","VRI"],["P","PTS"]]),l=new Map([["‡∂Ö","‡∂Ö‡∂û‡∑ä‡∂ú‡∑î‡∂≠‡∑ä‡∂≠‡∂ª‡∂±‡∑í‡∂ö‡∑è‡∂∫‡∂¥‡∑è‡∂Ω‡∑í"],["‡∂Ö‡∂ß‡∑ä‡∂®","‡∂Ö‡∂ß‡∑ä‡∂®‡∂ö‡∂Æ‡∑è"],["‡∂†‡∑ñ‡∑Ö‡∂±‡∑í","‡∂†‡∑ñ‡∑Ö‡∂±‡∑í‡∂Ø‡∑ä‡∂Ø‡∑ô‡∑É‡∂¥‡∑è‡∂Ω‡∑í"],["‡∂Ø‡∑ì","‡∂Ø‡∑ì‡∂ù‡∂±‡∑í‡∂ö‡∑è‡∂∫‡∂¥‡∑è‡∂Ω‡∑í"],["‡∂â‡∂≠‡∑í‡∑Ä‡∑î","‡∂â‡∂≠‡∑í‡∑Ä‡∑î‡∂≠‡∑ä‡∂≠‡∂ö‡∂¥‡∑è‡∂Ω‡∑í"],["‡∂¢‡∑è","‡∂¢‡∑è‡∂≠‡∂ö‡∂¥‡∑è‡∂Ω‡∑í"],["‡∂ö‡∂Ç",[{UT:"Cambodian Edition"}]],["‡∂ö",[{UT:"Cambodian Edition"}]],["‡∂õ‡∑î","‡∂õ‡∑î‡∂Ø‡∑ä‡∂Ø‡∂ö‡∂±‡∑í‡∂ö‡∑è‡∂∫‡∂¥‡∑è‡∂Ω‡∑í"],["‡∂∏","‡∂∏‡∂¢‡∑ä‡∂£‡∑í‡∂∏‡∂±‡∑í‡∂ö‡∑è‡∂∫‡∂¥‡∑è‡∂Ω‡∑í"],["‡∂∏‡∑Ñ‡∑è‡∂±‡∑í","‡∂∏‡∑Ñ‡∑è‡∂±‡∑í‡∂Ø‡∑ä‡∂Ø‡∑ô‡∑É‡∂¥‡∑è‡∂Ω‡∑í"],["‡∂∏‡∑Ñ‡∑è‡∑Ä","‡∂∏‡∑Ñ‡∑è‡∑Ä‡∂Ç‡∑É"],["‡∂∏‡∑ú‡∂ú","‡∂∏‡∑ú‡∂ú‡∑ä‡∂ú‡∂Ω‡∑ä‡∂Ω‡∑è‡∂±‡∂∂‡∑ä‡∂∫‡∑è‡∂ö‡∂ª‡∂´‡∂Ç (?)"],["‡∂∏‡∑î","‡∂∏‡∑ñ‡∂Ω (?)"],["‡∂±‡∑í","‡∂±‡∑í‡∂ö‡∑è‡∂∫"],["‡∂¥","‡∂¥‡∂ß‡∑í‡∑É‡∂∏‡∑ä‡∂∑‡∑í‡∂Ø‡∑è‡∂∏‡∂ú‡∑ä‡∂ú‡∂¥‡∑è‡∂Ω‡∑í/ ‡∂¥‡∂ß‡∑ä‡∂®‡∑è‡∂±‡∂¥‡∑è‡∂Ω‡∑í"],["‡∂¥‡∑ì",[{UT:"Pali Text Society Edition"}]],["‡∂¥‡∑ô","‡∂¥‡∑ô‡∂≠‡∑Ä‡∂≠‡∑ä‡∂Æ‡∑î‡∂¥‡∑è‡∂Ω‡∑í/ ‡∂¥‡∑ô‡∂ß‡∂ö‡∑ú‡∂¥‡∂Ø‡∑ô‡∑É‡∂¥‡∑è‡∂Ω‡∑í / ‡∂¥‡∑ô‡∂∫‡∑ä‡∂∫‡∑è‡∂Ω"],["‡∂¥‡∑î","‡∂¥‡∑î‡∂ú‡∑ä‡∂ú‡∂Ω‡∂¥‡∂§‡∑ä‡∂§‡∂≠‡∑ä‡∂≠‡∑í‡∂¥‡∑è‡∂Ω‡∑í"],["‡∂¥‡∑è‡∂†‡∑í","‡∂¥‡∑è‡∂†‡∑í‡∂≠‡∑ä‡∂≠‡∑í‡∂∫‡∂¥‡∑è‡∂Ω‡∑í"],["‡∂¥‡∑è‡∂ª‡∑è","‡∂¥‡∑è‡∂ª‡∑è‡∂¢‡∑í‡∂ö‡∂ö‡∂´‡∑ä‡∂©‡∂¥‡∑è‡∂Ω‡∑í"],["‡∂ª‡∑ñ","‡∂ª‡∑ñ‡∂¥‡∑è‡∑Ä‡∂†‡∂ª(?)"],["‡∑É‡∂Ç","‡∑É‡∂Ç‡∂∫‡∑î‡∂≠‡∑ä‡∂≠‡∂±‡∑í‡∂ö‡∑è‡∂∫‡∂¥‡∑è‡∂Ω‡∑í"],["‡∑É‡∑ì",[{UT:"Sri Lankan Edition"}]],["‡∑É‡∑ä‚Äç‡∂∫‡∑è",[{UT:"Thai Edition"}]],["‡∑É‡∑î","‡∑É‡∑î‡∂≠‡∑ä‡∂≠‡∂¥‡∑í‡∂ß‡∂ö/ ‡∑É‡∑î‡∂≠‡∑ä‡∂≠‡∂Ç (?)"],["‡∂Æ‡∑ô‡∂ª‡∂ú‡∑è","‡∂Æ‡∑ô‡∂ª‡∂ú‡∑è‡∂Æ‡∑è‡∂¥‡∑è‡∂Ω‡∑í"],["‡∂ã‡∂Ø‡∑è","‡∂ã‡∂Ø‡∑è‡∂±‡∂¥‡∑è‡∂Ω‡∑í"],["‡∑Ä‡∑í","‡∑Ä‡∑í‡∂∏‡∑è‡∂±‡∑Ä‡∂≠‡∑ä‡∂Æ‡∑î‡∂¥‡∑è‡∂Ω‡∑í"],["‡∑Ä‡∑í‡∑É‡∑î‡∂Ø‡∑ä‡∂∞‡∑í","‡∑Ä‡∑í‡∑É‡∑î‡∂Ø‡∑ä‡∂∞‡∑í‡∂∏‡∂ú‡∑ä‡∂ú"],["‡∂ß‡∑ì","‡∂ß‡∑ì‡∂ö‡∑è"],["‡∑Ä‡∑è ‡∂Ö‡∑É‡∑ä‡∑É",[{PT:"‚Äú‡∂≠‡∑É‡∑ä‡∑É ‡∂ë‡∑Ä‡∂Ç ‡∂Ö‡∂∫‡∑ú‡∂±‡∑í‡∑É‡∑ú ‡∂∏‡∂±‡∑É‡∑í‡∂ö‡∂ª‡∑ú‡∂≠‡∑ú ‡∂°‡∂±‡∑ä‡∂±‡∂Ç ‡∂Ø‡∑í‡∂ß‡∑ä‡∂®‡∑ì‡∂±‡∂Ç ‡∂Ö‡∂§‡∑ä‡∂§‡∂≠‡∂ª‡∑è ‡∂Ø‡∑í‡∂ß‡∑ä‡∂®‡∑í ‡∂ã‡∂¥‡∑ä‡∂¥‡∂¢‡∑ä‡∂¢‡∂≠‡∑í. ‚Äò‡∂Ö‡∂≠‡∑ä‡∂Æ‡∑í ‡∂∏‡∑ô ‡∂Ö‡∂≠‡∑ä‡∂≠‡∑è‚Äô‡∂≠‡∑í ‡∑Ä‡∑è ‡∂Ö‡∑É‡∑ä‡∑É, ‡∑É‡∂†‡∑ä‡∂†‡∂≠‡∑ú ‡∂Æ‡∑ô‡∂≠‡∂≠‡∑ú ‡∂Ø‡∑í‡∂ß‡∑ä‡∂®‡∑í ‡∂ã‡∂¥‡∑ä‡∂¥‡∂¢‡∑ä‡∂¢‡∂≠‡∑í; ‚Äò‡∂±‡∂≠‡∑ä‡∂Æ‡∑í ‡∂∏‡∑ô ‡∂Ö‡∂≠‡∑ä‡∂≠‡∑è‚Äô‡∂≠‡∑í ‡∑Ä‡∑è ‡∂Ö‡∑É‡∑ä‡∑É ‡∑É‡∂†‡∑ä‡∂†‡∂≠‡∑ú ‡∂Æ‡∑ô‡∂≠‡∂≠‡∑ú ‡∂Ø‡∑í‡∂ß‡∑ä‡∂®‡∑í ‡∂ã‡∂¥‡∑ä‡∂¥‡∂¢‡∑ä‡∂¢‡∂≠‡∑í; (‡∂∏‡∂¢‡∑ä‡∂£‡∑í‡∂∏‡∂±‡∑í‡∂ö‡∑è‡∂∫, ‡∂∏‡∑ñ‡∂Ω‡∂¥‡∂´‡∑ä‡∂´‡∑è‡∑É‡∂¥‡∑è‡∂Ω‡∑í, 1.11)."},{UT:"Here vƒÅ= or, an indeclinable and a conjunction. Assa= tassa= to him/ his. In some editions a sandhi is made as vƒÅ+assa= vƒÅssa."}]]]);class h{static registerEvents(t){t.root.on("click","pb",t=>h.showPageTagBox(t))}static render(t){"none"==i.appSettings.get("pageTagFormat")?t.children("pb").remove():t.children("pb").each((t,e)=>h.getPageTagDisplay($(e)))}static getPageTagDisplay(t){const[e,s,a,r]=h.decodeAttr(t);"click"==i.appSettings.get("pageTagFormat")?t.text("¬∂").addClass("click"):"short"==i.appSettings.get("pageTagFormat")?t.text(`[${e}: ${a}.${r}]`):t.html(`[<i>${s}</i> ${a}.${r}]`),t.addClass(e)}static showPageTagBox(t){const e=$(t.currentTarget),[s,a,i,r]=h.decodeAttr(e);$("#pagetag-book").text(i).parent().toggle(!!i),$("#pagetag-page").text(r),$("#pagetag-edition").text(a),n.Util.showDialog("pagetag-dialog","",e)}static decodeAttr(t){let e,s;for(let a of c)if(s=t.attr(a[0])){e=a;break}let[a,i]=s.split(".");return[e[0],e[1],a,i]}}e.PageTag=h;class d{static registerEvents(t){t.root.on("click","n.click",e=>d.showNoteBox(e,t.script)).on("click","abbr",e=>d.showAbbrBox(e,t.script))}static render(t){"none"==i.appSettings.get("footnoteFormat")?t.children("n").remove():"click"==i.appSettings.get("footnoteFormat")?t.children("n").each((t,e)=>{$(e).attr("text",$(e).text()).empty().addClass("click")}):t.children("n").each((t,e)=>$(e).html(`[${d.noteTextToHtml($(e).text())}]`))}static noteTextToHtml(t){return t.replace(/([^\s\(]+?[¬∑‡•∞])/g,"<abbr>$1</abbr>")}static showAbbrBox(t,e){const s=$(t.currentTarget);let r=a.TextProcessor.convertFrom(s.text().slice(0,-1),e);r=a.TextProcessor.beautify(r,a.Script.SI);const o=l.get(r);if(!o)return void console.error(`Could not find the abbreviation for the abbr ${r}`);let c=[];"string"!=typeof o?c=o.map(t=>t.PT?d.getAbbrFromPT(t.PT,e):t.UT?(0,i.UT)(t.UT):void 0):c.push(d.getAbbrFromPT(o,e)),n.Util.showDialog("abbreviations-dialog",c,s)}static getAbbrFromPT(t,e){return $("<i/>").addClass("PT").attr("script",e).text(a.TextProcessor.convert(t,e))}static showNoteBox(t,e){console.log(e);const s=$(t.currentTarget),a=$("<n/>").addClass("PT").attr("script",e).html(d.noteTextToHtml(s.attr("text")));n.Util.showDialog("generic-dialog",a,s),a.on("click","abbr",t=>d.showAbbrBox(t,e))}}e.Note=d;e.Collection=class{constructor(t,e,s,a){this.collObj=t,this.root=e,this.fileId=s,this.tabs=a,this.registerClicks()}registerClicks(){this.root.on("click",".coll-button",t=>{const e=r.PitakaTree.filterCollection(this.collObj,$(t.currentTarget).attr("na"));this.tabs.newTab(e[2],e[1],this.collObj)})}renderTop(){this.buttons=$('<div class="coll-buttons top"/>').appendTo(this.root),this.collObj.n.filter(t=>t[2]!=this.fileId).forEach(t=>{const e=t[0].toUpperCase();$(`<span class="coll-button ${e.charAt(0)}" na="${e.toLowerCase()}">${e}</span>`).appendTo(this.buttons)})}renderOnClick(){}};class p{constructor(t){this.fileDisplay=t,this.root=this.fileDisplay.root,this.registerClicks()}static initClipboard(){new ClipboardJS(".share-icon",{text:function(t){const e=$(t),s=e.parents(".tab-content"),a=e.parents("[line-ind]").first().attr("line-ind");return p.createLink(s.attr("file-id"),a,s.attr("script"))}}).on("success",t=>n.Util.showToast((0,i.UT)("copy-link")))}registerClicks(){}openAndHighlightLine(t){if(!t)return;const e=this.root.children(`[line-ind=${t}]`).first();e&&(e.css("background-color","lightyellow"),this.openDivToShowLine(e),this.fileDisplay.scrollToDiv(e))}openDivToShowLine(t){const e=t.attr("class").split(" ")[0];let s=t;$.inArray(e,["bod","gax","gae"])>=0&&(s=t.prevAll("[tt]").first()),s.hasClass("open")||this.fileDisplay.openTitleDiv(s)}openHighlightedLines(){let t=1e10;this.root.find("f").parents("[line-ind]").each((e,s)=>{this.openDivToShowLine($(s)),t=Math.min($(s).attr("line-ind"),t)}),this.fileDisplay.scrollToDiv(this.root.children(`[line-ind=${t}]`))}static createLink(t,e,s){return`https://tipitaka.app/?a=${t}-${e}-${s}`}static tryStartupLocation(t,e){const s=n.Util.getParameterByName("a","").split("-");if(!s)return!1;let[o,c,l]=s;if(l&&a.Script[l]&&"default"==i.appSettings.paliScriptSource&&i.appSettings.set("paliScript",l),$.isNumeric(c)||(c=0),o&&!t.fileIdToColl[o])showToast(`Can not open direct link. Malformed file id ${o}`);else if(o){const s=t.getCollection(o),a=r.PitakaTree.filterCollection(s,o);return t.openBranch(o),e.newTab(o,a[1],s,{lineToOpen:Number(c)}),!0}return!1}}e.LinkHandler=p;e.HitHighlighter=class{static markOffsets(t,e){const s=new Map;e.offsets.forEach((t,e)=>t.forEach((t,a)=>s.set(t,[e,a])));const a=(t=t.replace(/([^‡¥Ç-‡∑ü])([‡∂Ö-‡∑Ü])/g,"$1‡∑¥$2").replace(/<n>(.+?)<\/n>/g,(t,e)=>`<n>${e.replace(/‡∑¥/g,"")}</n>`)).replace(/<n>.+?<\/n>|[\u0964\u0965\u0970]|[A-Za-z0-9\.\?\,!;'"‚Äò‚Äô‚Äú‚Äù‚Äì<>=\:\\\/\[\]\+\(\)]/g,"").replace(/[-‚Ä¶¬ß\s\r\n]+/g," ").split(" ");let i=0;const r=new Map;a.forEach((t,a)=>{s.has(a)&&(r.set(i,s.get(a)),e.words[s.get(a)[1]]!=t.substring(1)&&console.log(`token ${t.substring(1)} at offset ${a} not matching with word ${e.words[s.get(a)[1]]}`)),i+=(t.match(/‡∑¥/g)||[]).length}),console.log(`spcCount: ${i}, offsetsMap: ${s.size} tagLocations Found: ${r.size}`);let n=0,o=0;return t=t.replace(/‡∑¥([^-‚Ä¶¬ß\s\r\n<‡∑¥]*)/g,(t,e,s)=>{if(n++,r.has(n-1)){o++;const t=r.get(n-1);return`<f oi="${t[0]}" ti="${t[1]}">${e}</f>`}return e}),console.log(`TagLocations marked: ${o} spcCount2: ${n}`),t}};e.WordDisplay=class{constructor(t){this.fileDisplay=t,this.root=this.fileDisplay.root,this.registerClicks(),this.settings={hoverDelay:500},this.hoverTimer=null}registerClicks(){this.root.on("mouseenter","w",t=>this.registerShowInfo(t,"hover")).on("mouseleave","w",t=>{this.hoverTimer&&clearTimeout(this.hoverTimer),this.closeInfoBox()}).on("click","w",t=>this.registerShowInfo(t,"click"))}registerShowInfo(t,e){if(i.appSettings.get("dictLaunchMethod")!=e)return;if(!o.dictHandler.activeDicts.size)return;if(this.dictDlg&&this.dictDlg.isOpen)return;const s=$(t.currentTarget);s.parents("[tt]").length||(this.hoverTimer&&clearTimeout(this.hoverTimer),"hover"==e?this.hoverTimer=setTimeout(()=>this.showInfoBox(s),this.settings.hoverDelay):this.showInfoBox(s))}showInfoBox(t,e=""){const s=e||t.text();o.dictHandler.searchWord(s,this.fileDisplay.script).then(e=>{if(e.length){const s=$("<div/>").append(e).css("padding","0.33rem");this.dictDlg&&this.dictDlg.close(),this.dictDlg=new n.JDialog(t,t,{"max-width":400,top:"100%"}).show(s,this.root),s.width()>380&&$(".dict-row",s).css("white-space","normal")}else if(!this.wordEditDlg||!this.wordEditDlg.isOpen){const e=$("<input/>").addClass("PT").attr("type","text").val(t.text()).attr("script",this.fileDisplay.script).css("padding","0.33rem");this.wordEditDlg=new n.JDialog(t,t,{bottom:"100%"}).show(e,this.root),e.focus().on("input",s=>e.val()?this.showInfoBox(t,e.val()):"")}}).catch(t=>{console.error(`Error searching word ${s} : ${t}`)})}closeInfoBox(){this.dictDlg&&this.dictDlg.isOpen&&this.dictDlg.close(),this.wordEditDlg&&this.wordEditDlg.isOpen&&this.wordEditDlg.close()}markWords(t){return t.replace(/([‡¥Ç-‡∑ü]+)/g,"<w>$1</w>")}};new Map([["a","a·πÖguttaranikƒÅyapƒÅli"],["a·π≠·π≠ha","a·π≠·π≠hakathƒÅ"],["c≈´·∏∑ani","c≈´·∏∑aniddesapƒÅli"],["dƒ´","dƒ´ghanikƒÅyapƒÅli"],["itivu","itivuttakapƒÅli"],["jƒÅ","jƒÅtakapƒÅli"],["ka·πÉ",[{UT:"Cambodian Edition"}]],["ka",[{UT:"Cambodian Edition"}]],["khu","khuddakanikƒÅyapƒÅli"],["ma","majjhimanikƒÅyapƒÅli"],["mahƒÅni","mahƒÅniddesapƒÅli"],["mahƒÅva","mahƒÅva·πÉsa"],["moga","moggallƒÅnabyƒÅkara·πáa·πÉ (?)"],["mu","m≈´la (?)"],["ni","nikƒÅya"],["pa","pa·π≠isambhidƒÅmaggapƒÅli/ pa·π≠·π≠hƒÅnapƒÅli"],["pƒ´",[{UT:"Pali Text Society Edition"}]],["pe","petavatthupƒÅli/ pe·π≠akopadesapƒÅli / peyyƒÅla"],["pu","puggalapa√±√±attipƒÅli"],["pƒÅci","pƒÅcittiyapƒÅli"],["pƒÅrƒÅ","pƒÅrƒÅjikaka·πá·∏çapƒÅli"],["r≈´","r≈´pƒÅvacara(?)"],["sa·πÉ","sa·πÉyuttanikƒÅyapƒÅli"],["sƒ´",[{UT:"Sri Lankan Edition"}]],["su","suttapi·π≠aka/ sutta·πÉ (?)"],["syƒÅ",[{UT:"Thai Edition"}]],["theragƒÅ","theragƒÅthƒÅpƒÅli"],["udƒÅ","udƒÅnapƒÅli"],["vi","vimƒÅnavatthupƒÅli"],["visuddhi","visuddhimagga"],["·π≠ƒ´","·π≠ƒ´kƒÅ"],["vƒÅ assa",[{PT:"‚ÄúTassa eva·πÉ ayoniso manasikaroto channa·πÉ di·π≠·π≠hƒ´na·πÉ a√±√±atarƒÅ di·π≠·π≠hi uppajjati. ‚ÄòAtthi me attƒÅ‚Äôti vƒÅ assa, saccato thetato di·π≠·π≠hi uppajjati; ‚Äònatthi me attƒÅ‚Äôti vƒÅ assa saccato thetato di·π≠·π≠hi uppajjati; (majjhimanikƒÅya, m≈´lapa·πá·πáƒÅsapƒÅli, page 1.11)."},{UT:"Here vƒÅ= or, an indeclinable and a conjunction. Assa= tassa= to him/ his. In some editions a sandhi is made as vƒÅ+assa= vƒÅssa."}]]])},function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.dictHandler=void 0;var a=s(1),i=s(0),r=s(2);const n=new Map([["ch-suttacentral",[i.Language.CHINESE,"SC Chinese",{s:"SC",v:1,d:"SuttaCentral Chinese Dictionary"}]],["en-buddhadatta",[i.Language.EN,"Buddhadatta Concise",{s:"BU",v:1}]],["en-vri",[i.Language.EN,"VRI English",{s:"VR",v:1}]],["hi-vri",[i.Language.HI,"VRI Hindi",{s:"VR",v:1}]],["in-suttacentral",[i.Language.INDO,"SC Indonesian",{s:"SC",v:1}]],["my-u-hau-sein",[i.Language.BUR,"U Hau Sein",{s:"HS",v:1}]],["si-buddhadatta",[i.Language.SI,"‡∂¥‡∑ú‡∂Ω‡∑ä‡∑Ä‡∂≠‡∑ä‡∂≠‡∑ö ‡∂∂‡∑î‡∂Ø‡∑ä‡∂∞‡∂Ø‡∂≠‡∑ä‡∂≠",{s:"BU",v:1,d:"‡∂¥‡∑ú‡∂Ω‡∑ä‡∑Ä‡∂≠‡∑ä‡∂≠‡∑ö ‡∂∂‡∑î‡∂Ø‡∑ä‡∂∞‡∂Ø‡∂≠‡∑ä‡∂≠ ‡∑Ñ‡∑í‡∂∏‡∑í, ‡∂¥‡∑è‡∂Ω‡∑í-‡∑É‡∑í‡∂Ç‡∑Ñ‡∂Ω ‡∂Ö‡∂ö‡∑è‡∂ª‡∑è‡∂Ø‡∑í‡∂∫"}]],["si-sumangala",[i.Language.SI,"‡∂∏‡∂©‡∑í‡∂≠‡∑í‡∂∫‡∑Ä‡∑ô‡∂Ω ‡∑É‡∑î‡∂∏‡∂û‡∑ä‡∂ú‡∂Ω",{s:"MS",v:2,d:"‡∂∏‡∂©‡∑í‡∂≠‡∑í‡∂∫‡∑Ä‡∑ô‡∂Ω ‡∑É‡∑í‡∂ª‡∑í ‡∑É‡∑î‡∂∏‡∂û‡∑ä‡∂ú‡∂Ω ‡∑Ñ‡∑í‡∂∏‡∑í, ‡∂¥‡∑è‡∂Ω‡∑í-‡∑É‡∑í‡∂Ç‡∑Ñ‡∂Ω ‡∑Å‡∂∂‡∑ä‡∂Ø‡∂ö‡∑ù‡∑Ç‡∂∫"}]],["th-aj-subhira",[i.Language.THAI,"‡∏™‡∏∏‡∏†‡∏µ‡∏£‡πå ‡∏ó‡∏∏‡∏°‡∏ó‡∏≠‡∏á",{s:"SU",v:1}]],["th-thaiware",[i.Language.THAI,"Thai Ware",{s:"TW",v:1}]]]);class o{constructor(t,e,s){this.dataUrl=s,this.dbName=t,this.dbVersion=e,this.dataLoading=!1,this.db=new Dexie(this.dbName),this.db.version(this.dbVersion).stores({dict:"++id,word"})}async load(){const t=await this.db.dict.count();if(t>0||this.dataLoading)console.log(`dictionary ${this.dbName}:${this.dbVersion} already in IDB size: ${t}`);else{this.dataLoading=!0;try{let t=await $.getJSON(this.dataUrl);t=t.filter(([t,e])=>t&&e),console.log(`${this.dbName} loaded from url of size ${t.length}`),await this.db.dict.bulkAdd(t.map(([t,e])=>({word:t,meaning:e})))}catch(t){throw new Error(`Failed to load the ${this.dbName} from ${this.dataUrl}. ${t}`)}console.log(`${this.dbName}:${this.dbVersion} loaded to IDB size: ${await this.db.dict.count()}`),this.dataLoading=!1}}async searchWord(t){if(this.dataLoading)return[];let e=await this.db.dict.where("word").equals(t).limit(10).toArray();if(!e.length){const s=t.replace(/[\u0DCA-\u0DDF\u0D82\u0D83]$/g,"");e=await this.db.dict.where("word").startsWith(s).limit(c).toArray()}return e}async clearDb(){await this.db.dict.clear()}}const c=10,l="./static/dicts";e.dictHandler=new class{constructor(){this.dictionaryList=n,this.loadedDicts=new Map,this.activeDicts=new Set(i.appSettings.get("dictList")),this.activeDicts.forEach(t=>this.loadDictionary(t)),this.registerEvents()}async loadDictionary(t){if(this.loadedDicts.has(t))return;const e=this.dictionaryList.get(t),s=new o(t,e[2].v,`${l}/${t}.json`);await s.load(),this.loadedDicts.set(t,s)}dictionaryListChanged(t){const e=$(t.currentTarget).attr("value");if(this.activeDicts.has(e))this.activeDicts.delete(e),i.appSettings.set("dictList",Array.from(this.activeDicts)),console.log(`Dictionary ${e} removed`);else{const s=new r.JDialog($(t.currentTarget),"").show($("<div/>").addClass("dict-loading").append((0,i.UT)("Loading dictionary...")));this.loadDictionary(e).then(()=>{s.close(),this.activeDicts.add(e),i.appSettings.set("dictList",Array.from(this.activeDicts)),console.log(`Dictionary ${e} added: ${i.appSettings.get("dictList")}`)}).catch(t=>{s.close(),console.error(`Dict ${e} loading failed. Error: ${t}`)})}}async searchWord(t,e){t=a.TextProcessor.convertFrom(t,e);const s=Array.from(this.activeDicts),i=await Promise.all(s.map(e=>this.loadedDicts.get(e).searchWord(t))),n=[];return s.forEach((e,s)=>n.push(...i[s].map(s=>(s.dictName=e,s.distance=r.Util.levenshtein(s.word,t),s)))),n.sort((t,e)=>t.distance-e.distance),console.log(n),n.splice(c),n.map(t=>{const s=this.dictionaryList.get(t.dictName),i=$("<span/>").addClass("dict-name").text(s[2].s).attr("dict-name",t.dictName),r=$("<span/>").addClass("dict-word PT").text(a.TextProcessor.convert(t.word,e)).attr("script",e),n=$("<span/>").addClass("dict-meaning UT").html(t.meaning).attr("lang",s[0]);return $("<div/>").append(i,r,n).addClass("dict-row")})}registerEvents(){$(document).on("mouseenter",".dict-name",t=>{const e=$(t.currentTarget);r.JHoverDialog.create("dict-name",300,e,()=>this.getDictHoverContents(e))}).on("mouseleave",".dict-name",t=>r.JHoverDialog.destroy("dict-name"))}getDictHoverContents(t){const e=this.dictionaryList.get(t.attr("dict-name"));return $("<div/>").addClass("dict-desc UT").attr("lang",e[0]).text(e[1])}},new Map([["a. hay adj.","Adjective"],["abs.","Absolutive"],["ad.","Adverb"],["aor.","Aorist"],["cpds.","Compounds"],["conj.","Conjunction"],["caus.","Causative"],["Deno.","Denominative verb"],["Des.","Desiderative verb"],["f.","Feminine"],["m.","Masculine"],["nt.","Neuter"],["Ger.","Gerund"],["intj.","Interjection"],["in.","Indeclinable"],["inf.","Infinitive"],["onom.","Onomatopoetic verb"],["pass","Passive"],["act.","Active"],["pp.","Past participle"],["pr. p.","Present participle"],["pt. p.","Potential participle"],["prep.","Preposition"],["pret.","Preterit verb"],["3","Of the three genders"],["Sin.","Singular"],["Pl.","Plural"],["Der.","Derivative"]]);const h={"si-sumangala":{"‡∂¥‡∑î.‡∂ö‡∑ä‚Äç‡∂ª‡∑í":["‡∂¥‡∑î‡∂∂‡∑ä‡∂∂ ‡∂ö‡∑ä‚Äç‡∂ª‡∑í‡∂∫‡∑è",0],"‡∂Ö":["‡∂Ö‡∑Ä‡∑ä‚Äç‡∂∫‡∂∫ ‡∑É‡∂Ø‡∑ä‡∂Ø",0],"‡∂¥‡∑î":["‡∂¥‡∑î‡∂Ω‡∑ä‡∂Ω‡∑í‡∂û‡∑ä‡∂ú‡∑í‡∂ö","c1"],"‡∂â":["‡∂â‡∂≠‡∑ä‚Äç‡∂Æ‡∑í ‡∂Ω‡∑í‡∂û‡∑ä‡∂ú‡∑í‡∂ö","c1"],"‡∂±":["‡∂±‡∂¥‡∑î‡∂Ç‡∑É‡∂ö ‡∂Ω‡∑í‡∂û‡∑ä‡∂ú‡∑í‡∂ö","c1"],"‡∂ë":["‡∂ë‡∂ö‡∂ö ‡∂±‡∑í‡∂¥‡∑è‡∂≠",2],"‡∂Ø‡∑î":["‡∂Ø‡∑î‡∂ö‡∂±‡∑í‡∂¥‡∑è‡∂≠",2],"‡∂≠":["‡∂≠‡∂≠‡∑í‡∂∫",2],"‡∂±‡∑í":["‡∂±‡∑í‡∂¥‡∑è‡∂≠",2],"‡∂¥":["‡∂¥‡∂´‡∑ä‡∂´‡∑è‡∑É‡∂ö",2],"‡∂≠‡∑í":["‡∂≠‡∑í‡∂Ω‡∑í‡∂û‡∑ä‡∂ú‡∑í‡∂ö","c1"],"‡∂ö‡∑ä‚Äç‡∂ª‡∑í":["‡∂ö‡∑ä‚Äç‡∂ª‡∑í‡∂∫‡∑è",0],"‡∑Ä‡∑í":["‡∑Ä‡∑í‡∂∑‡∑è‡∑Ä‡∑í‡∂±‡∑ì",0],"‡∑Ä":["‡∑Ä‡∂´‡∑ä‡∂´‡∂±‡∑è",0],d:["‡∂∞‡∑è‡∂≠‡∑î",0],"‡∂∑‡∑î":["‡∂∑‡∑î‡∑Ä‡∑è‡∂Ø‡∑í‡∂ú‡∂´‡∂∫",4],"‡∂ª‡∑î":["‡∂ª‡∑î‡∂∞‡∑è‡∂Ø‡∑í‡∂ú‡∂´‡∂∫",4],"‡∂Ø‡∑í":["‡∂Ø‡∑í‡∑Ä‡∑è‡∂Ø‡∑í‡∂ú‡∂´‡∂∫",4],"‡∑É‡∑î":["‡∑É‡∑ä‡∑Ä‡∑è‡∂Ø‡∑í‡∂ú‡∂´‡∂∫",4],"‡∂ö‡∑í":["‡∂ö‡∑í‡∂∫‡∑è‡∂Ø‡∑í‡∂ú‡∂´‡∂∫",4],"‡∂≠2":["‡∂≠‡∂±‡∑è‡∂Ø‡∑í‡∂ú‡∂´‡∂∫",4],"‡∂†‡∑î":["‡∂†‡∑î‡∂ª‡∑è‡∂Ø‡∑í‡∂ú‡∂´‡∂∫",4],"‡∂Ö2":["‡∂ë‡∂±‡∂∏‡∑ä ‡∑Ä‡∑í‡∂ö‡∂ª‡∂´‡∂∫",5],"‡∂Ö‡∂Ç":["‡∂ë‡∂±‡∂∏‡∑ä ‡∑Ä‡∑í‡∂ö‡∂ª‡∂´‡∂∫",5],"‡∂∫":["‡∂ë‡∂±‡∂∏‡∑ä ‡∑Ä‡∑í‡∂ö‡∂ª‡∂´‡∂∫",5],"‡∂´‡∑î ‡∂´, ‡∂∫‡∑í‡∂ª":["‡∂ë‡∂±‡∂∏‡∑ä ‡∑Ä‡∑í‡∂ö‡∂ª‡∂´‡∂∫",5],"‡∂´‡∑è":["‡∂ë‡∂±‡∂∏‡∑ä ‡∑Ä‡∑í‡∂ö‡∂ª‡∂´‡∂∫",5],"‡∂î, ‡∂ã‡∂´‡∑è":["‡∂ë‡∂±‡∂∏‡∑ä ‡∑Ä‡∑í‡∂ö‡∂ª‡∂´‡∂∫",5],"‡∂´‡∑ô, ‡∂´‡∂∫":["‡∂ë‡∂±‡∂∏‡∑ä ‡∑Ä‡∑í‡∂ö‡∂ª‡∂´‡∂∫",5]}};h["si-buddhadatta"]={"‡∂¥‡∑ñ.‡∂ö‡∑ä‚Äç‡∂ª‡∑í":["‡∂¥‡∑ñ‡∂ª‡∑ä‡∑Ä ‡∂ö‡∑ä‚Äç‡∂ª‡∑í‡∂∫‡∑è",0],"‡∂ö‡∑ä‚Äç‡∂ª‡∑í.‡∑Ä‡∑í":["‡∂ö‡∑ä‚Äç‡∂ª‡∑í‡∂∫‡∑è ‡∑Ä‡∑í‡∑Å‡∑ö‡∑Ç‡∂´",0],"‡∂±‡∑í":["‡∂±‡∑í‡∂¥‡∑è‡∂≠",0],"‡∂¥‡∑î":["‡∂¥‡∑î‡∂Ω‡∑ä ‡∂Ω‡∑í‡∂û‡∑ä‡∂ú","c1"],"‡∂â":["‡∂â‡∂≠‡∑ä‚Äç‡∂Æ‡∑í ‡∂Ω‡∑í‡∂û‡∑ä‡∂ú","c1"],"‡∂±":["‡∂±‡∂¥‡∑î‡∂Ç‡∑É‡∂ö ‡∂Ω‡∑í‡∂û‡∑ä‡∂ú","c1"],3:["‡∂≠‡∑î‡∂±‡∑ä ‡∂Ω‡∑í‡∂ü‡∑î ‡∂á‡∂≠‡∑í","c1"]}},function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.bookmarks=e.TitleSearch=void 0;var a=s(1),i=s(0),r=s(3),n=s(2),o=s(4);class c{constructor(t,e,s){this.root=t,this.tree=e,this.tabs=s,this.searchPrevQuery="",this.searchCache=new Map,this.settings={minQueryLength:2,maxResults:100}}init(){this.filterParents=i.appSettings.get("title-search-filter"),this.filterParents||(this.filterParents=o.TSH.topParentsInfo.slice(0,-1).map(t=>t[0]),i.appSettings.set("title-search-filter",this.filterParents)),this.filter=new o.SearchFilter($("#search-filter"),o.TSH.topParentsInfo,this.filterParents,this),this.registerClicks(),console.log(`search index loaded with length ${o.TSH.data.length}`)}registerClicks(){$("#search-filter-button").click(t=>$("#search-filter").slideToggle("fast")),$("#search-results").on("click","i.name",t=>c.openResult(t,this.tree,this.tabs))}static openResult(t,e,s){const a=o.TSH.data[$(t.currentTarget).attr("index")],i=a[o.TSE.file],n=e.getCollection(i),c=r.PitakaTree.filterCollection(n,i);s.newTab(i,c[1],n,{lineToOpen:Number(a[o.TSE.lineInd])}),e.openBranch(i)}performSearch(t){const e=a.TextProcessor.convertFromMixed(t);if(e!=this.searchPrevQuery)if($("#search-results",this.root).empty(),this.searchPrevQuery=e,e.length<this.settings.minQueryLength)this.setStatus((0,i.UT)("enter-more-characters",this.settings.minQueryLength));else{console.log(`starting the search with query ${e}`);const t=this.searchIndex(e);this.displayResults(t)}}checkQuery(t,e){return e.exec(t[o.TSE.name])&&(this.filterParents.length==o.TSH.topParentsInfo.length||this.filterParents.indexOf(t[o.TSE.parents][0])>=0)}searchIndex(t){if(this.searchCache.has(t)){const e=this.searchCache.get(t);return console.log(`Results for query ${t} found in cache of length ${e.length}`),e}const e=new RegExp(t,"i"),s=[];for(let t=0;t<o.TSH.data.length&&(this.checkQuery(o.TSH.data[t],e)&&s.push(t),!(s.length>=this.settings.maxResults));t++);return console.log(`Search for ${t} in index found ${s.length} hits`),this.searchCache.set(t,s),s}setStatus(t){$("#search-status",this.root).empty().append(t)}displayResults(t){const e=$("#search-results",this.root).empty();t?(e.append(c.createResultsList(t)),e.show(),t.length<this.settings.maxResults?this.setStatus((0,i.UT)("number-of-results-found",t.length)):this.setStatus((0,i.UT)("too-many-results-found",this.settings.maxResults))):this.setStatus((0,i.UT)("no-results-found",this.searchPrevQuery))}changeScript(){(0,i.PT_REFRESH)(this.root)}filterChanged(t){this.filterParents=t,i.appSettings.set("title-search-filter",this.filterParents),console.log(t),this.searchCache.clear();const e=this.searchIndex(this.searchPrevQuery);this.displayResults(e)}static createResultsList(t){return t.map(t=>{const e=o.TSH.data[t],s=$("<div/>").addClass("search-result").attr("index",t);return e[o.TSE.parents].forEach(t=>{(0,i.PT)(o.TSH.data[t][o.TSE.name]).addClass("parent name").attr("index",t).appendTo(s),$("<i/>").text(" ¬ª ").appendTo(s)}),(0,i.PT)(e[o.TSE.name]).addClass("child name").attr("index",t).appendTo(s),l.getIcon(e[o.TSE.file],e[o.TSE.lineInd]).appendTo(s),s})}}e.TitleSearch=c;const l=e.bookmarks=new class{constructor(){this.list={}}init(t,e){this.tree=t,this.tabs=e;const s=localStorage.getItem("bookmarks");s&&(this.list=JSON.parse(s)),this.registerClicks(),this.updateCount(),this.filterParents=i.appSettings.get("bookmarks-filter"),this.filterParents||(this.filterParents=o.TSH.topParentsInfo.map(t=>t[0]),i.appSettings.set("bookmarks-filter",this.filterParents)),this.filter=new o.SearchFilter($("#bookmarks-filter"),o.TSH.topParentsInfo,this.filterParents,this)}registerClicks(){$("body").on("click","i.save-icon",t=>{const e=$(t.currentTarget),s=e.attr("key");this.list[s]?(e.removeClass("saved"),delete this.list[s],console.log(`bookmark ${s} deleted`)):(e.addClass("saved"),this.list[s]=Date.now(),console.log(`bookmark ${s} added`)),localStorage.setItem("bookmarks",JSON.stringify(this.list)),this.updateCount()}),$("#bookmarks-button").click(t=>{this.renderBookmarks(),n.vManager.showPane("bookmarks")}),$("#bookmarks-filter-button").click(t=>$("#bookmarks-filter").slideToggle("fast")),$("#bookmarks-list").on("click","i.name",t=>c.openResult(t,this.tree,this.tabs))}updateCount(){$("#bookmarks-count").text(Object.keys(this.list).length)}getIcon(t,e){const s=`${t},${e}`;return $("<i/>").addClass("far fa-star save-icon action-icon").toggleClass("saved",this.list[s]>0).attr("key",s)}renderBookmarks(){const t=$("#bookmarks-list").empty();if(!Object.keys(this.list).length)return void this.setStatus((0,i.UT)("no-bookmarks"));const e=[];o.TSH.data.forEach(t=>{const s=`${t[o.TSE.file]},${t[o.TSE.lineInd]}`;this.list[s]&&this.checkFilter(t)&&e.push(t[o.TSE.id])}),t.append(c.createResultsList(e)),this.setStatus((0,i.UT)("number-of-bookmarks",e.length))}checkFilter(t){return this.filterParents.length==o.TSH.topParentsInfo.length||this.filterParents.indexOf(t[o.TSE.parents][0])>=0}filterChanged(t){this.filterParents=t,i.appSettings.set("bookmarks-filter",this.filterParents),this.renderBookmarks()}setStatus(t){$("#bookmarks-status").empty().append(t)}changeScript(){(0,i.PT_REFRESH)($("#bookmarks-area"))}}},function(t,e,s){"use strict";var a=s(1),i=s(0),r=s(9),n=s(3),o=s(5),c=s(4),l=s(7),h=s(11),d=s(2),p=s(6);const g=new n.PitakaTree($(".pitaka-tree")),u=new r.PitakaTabs($(".text-section"),g);g.initialize(u).done(function(){o.LinkHandler.initClipboard(),o.LinkHandler.tryStartupLocation(g,u)});const f=new l.TitleSearch($("#search-area"),g,u),m=new h.FTSHandler;function T(t){t&&t.stopPropagation();const e=$(".search-bar").val().trim();S?(d.vManager.showPane("fts"),m.performSearch(e)):(d.vManager.showPane("search"),f.performSearch(e));const s=(0,a.getScriptForCode)(e?e.charCodeAt(0):0);$(".search-bar").attr("script",s)}c.TSH.init().then(()=>{$(".search-bar").on("input",t=>T(t)),$(".search-bar").focus(t=>S?d.vManager.showPane("fts"):d.vManager.showPane("search")),f.init(),l.bookmarks.init(g,u),m.init(g,u)}).catch(t=>{console.error(`Title Search Index init failed with error ${t}`)});let S=!1;$("#fts-select-button").click(t=>(function(t){$("#fts-select-button").toggleClass("active",t).children().toggleClass("fal",!t).toggleClass("fas",t),(S=t)&&m.checkInit(),T()})(!S));const b=$("#pali-script-select");function v(t){$("html").css("font-size",`${t}px`)}function w(t,e,s,a=""){t.forEach((t,s)=>{const a=$("<span/>").append((0,i.UT)(t[0])),r=$(t[1]).addClass("example");$("<div/>").addClass("option").append(a,r).attr("value",s).appendTo(e)}),e.on("click",".option",t=>{const e=i.appSettings.set(s,$(t.currentTarget).attr("value"));a&&a(e)}).children(`[value=${i.appSettings.get(s)}]`).addClass("active")}i.appSettings.paliScriptList.forEach((t,e)=>{d.Util.createLanguageSelectOption(e,t).appendTo(b)}),b.on("click",".option",t=>{const e=$(t.currentTarget);console.log(`Pali script changing from ${i.appSettings.get("paliScript")} to ${e.attr("value")}`),i.appSettings.set("paliScript",e.attr("value")),g.changeScript(),u.changeScript(),f.changeScript(),l.bookmarks.changeScript(),m.changeScript()}).children(`[value=${i.appSettings.get("paliScript")}]`).addClass("active"),i.appSettings.uiLanguageList.forEach((t,e)=>{t[3].t&&d.Util.createLanguageSelectOption(e,t).appendTo($("#ui-lang-select"))}),$("#ui-lang-select").on("click",".option",t=>{i.appSettings.set("uiLanguage",$(t.currentTarget).attr("value")),i.LangHelper.changeTranslation(i.appSettings.get("uiLanguage"))}).children(`[value=${i.appSettings.get("uiLanguage")}]`).addClass("active"),p.dictHandler.dictionaryList.forEach((t,e)=>d.Util.createDictionarySelectOption(e,t,i.appSettings.uiLanguageList.get(t[0])).appendTo("#dictionary-select")),$("#dictionary-select").on("click",".check",t=>p.dictHandler.dictionaryListChanged(t)).children(i.appSettings.get("dictList").map(t=>`[value=${t}]`).join(",")||"none").addClass("active"),w(i.appSettings.dictLaunchList,$("#dictionary-launch-select"),"dictLaunchMethod"),w(i.appSettings.footnoteFormatList,$("#footnote-format-select"),"footnoteFormat",u.changeTextFormat.bind(u)),w(i.appSettings.pageTagFormatList,$("#pagetag-format-select"),"pageTagFormat",u.changeTextFormat.bind(u)),w(i.appSettings.textSizeList,$("#text-size-select"),"textSize",v),$(".custom-radio").on("click",".option:not(.check)",t=>{$(t.currentTarget).addClass("active").siblings().removeClass("active"),u.getNumTabs()&&d.vManager.showPane("back")}),$(".custom-radio").on("click",".check",t=>$(t.currentTarget).toggleClass("active")),i.LangHelper.changeTranslation(i.appSettings.get("uiLanguage")),v(i.appSettings.get("textSize"))},function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.PitakaTabs=void 0;var a=s(0),i=s(10),r=s(2);class n{constructor(t,e){this.root=t,this.appTree=e,this.tabs=new Map,this.files=new Map,this.activeTabId="",this.heads=$("div.tab-heads",this.root),this.contents=$("div.tab-contents",this.root),this.setTCView(a.appSettings.get("tabViewFormat")),this.registerClicks()}registerClicks(){this.heads.on("click",".tab-head",t=>{this.showTab($(t.currentTarget).attr("tab-id"))}),this.heads.on("click",".close-icon",t=>{this.removeTab($(t.currentTarget).parent().attr("tab-id")),t.stopPropagation()}),$("#columns-button").click(t=>this.switchTCView())}showTab(t){return!!this.tabs.has(t)&&(this.tabs.forEach(t=>t.forEach(t=>t.removeClass("active"))),this.tabs.get(t).forEach(t=>t.addClass("active")),this.activeTabId=t,!0)}removeTab(t){if(console.log(t),!this.tabs.has(t)||this.tabs.size<=1)return!1;this.tabs.get(t).forEach(t=>t.remove()),this.tabs.delete(t),this.files.delete(t),this.activeTabId==t&&this.showTab(this.tabs.keys().next().value)}newTab(t,e,s,c={}){r.vManager.showPane("text");const l=o(),h=(0,a.PT)(e.replace(/^[\(\)\d+\s\-\.]+/,"")),d=$("<span/>").append(h).addClass("head-label"),p=$("<span/>").addClass("close-icon far fa-times"),g=n.getCollIcon(t,s),u=$("<div/>").addClass("tab-head").append(g,d,p).appendTo(this.heads),f=$("<div/>").addClass("tab-content").appendTo(this.contents);u.add(f).attr("view",this.curTCView).attr("file-id",t).attr("tab-id",l);const m=new i.FileDisplay(f,this,t,s,c);m.load(),this.tabs.set(l,[u,f]),this.files.set(l,m),this.showTab(l)}changeScript(){if(0==this.tabs.size)return;const t=this.tabs.get(this.activeTabId)[0];(0,a.PT_REFRESH)(t),this.files.get(this.activeTabId).changeScript()}changeTextFormat(){this.files.forEach(t=>t.refresh())}getNumTabs(){return this.tabs.size}static getCollIcon(t,e){const s=e.n.find(e=>e[2]==t)[0].charAt(0).toUpperCase();return $("<span/>").addClass(s).addClass("coll-icon").text(s)}switchTCView(){const t="tabbed"==this.curTCView?"columns":"tabbed";a.appSettings.set("tabViewFormat",t),this.setTCView(t)}setTCView(t){this.curTCView=t,$(".tab-content,.tab-head").add(this.heads,this.contents).attr("view",this.curTCView);const e="tabbed"==t?"fa-columns":"fa-folders",s="tabbed"==t?"Columns":"Tabs";$("#columns-button").empty().append($("<i/>").addClass(`far fa-fw ${e}`)).append((0,a.UT)(s).addClass("ss-hide").css("padding-left","4pt"))}}e.PitakaTabs=n;const o=()=>`id-${Math.floor(1e6*Math.random())}`},function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.FileDisplay=void 0;var a=s(1),i=s(0),r=s(5),n=s(7);const o=new Map([["cha","1-2-3"],["tit","1-2"],["sub","1"]]);e.FileDisplay=class{constructor(t,e,s,a,n){this.root=t,this.fileId=s,this.collection=new r.Collection(a,this.root,this.fileId,e),this.linkHandler=new r.LinkHandler(this),this.wordDisplay=new r.WordDisplay(this),this.lineToOpen=n.lineToOpen||0,this.highlight=n,this.data="",this.script=i.appSettings.get("paliScript"),this.registerEvents()}load(){const t=new XMLHttpRequest;t.open("GET",`../static/text/${this.fileId}.txt`,!0),t.responseType="arraybuffer",t.onload=(e=>{this.data=function(t){const e=[];for(let s=0;s<t.length;s+=32768)e.push(String.fromCharCode.apply(null,t.subarray(s,s+32768)));return e.join("")}(new Uint16Array(t.response)),this.highlight.words&&(this.data=r.HitHighlighter.markOffsets(this.data,this.highlight)),this.data=this.wordDisplay.markWords(this.data),this.refresh(),this.linkHandler.openAndHighlightLine(this.lineToOpen),this.highlight.words&&this.linkHandler.openHighlightedLines()}),t.send()}registerEvents(){r.Note.registerEvents(this),r.PageTag.registerEvents(this),this.root.on("click","[tt] .line-text",t=>{const e=$(t.currentTarget).parent();this.openTitleDiv(e),this.scrollToDiv(e)}).on("click",".hangnum,.titnum",t=>this.collection.renderOnClick(t))}openTitleDiv(t){const e=t.toggleClass("open").nextUntil(`[tt|=${t.attr("tt")}]`);e.filter(":not([tt])").toggle(t.hasClass("open")),e.filter("[tt]").toggleClass("open",t.hasClass("open"))}scrollToDiv(t){t&&this.root.scrollTop(this.root.scrollTop()+t.position().top)}changeScript(){this.script!=i.appSettings.get("paliScript")&&(this.script=i.appSettings.get("paliScript"),this.refresh())}refresh(){this.root.empty().attr("script",this.script),a.TextProcessor.basicConvert(this.data,this.script).split("\r\n").forEach((t,e)=>{this.root.append(this.getDivForLine(t,e))}),1==this.root.find("[tt]").length&&this.root.find("[tt]").children(".line-text").click(),this.root.children(".cha").first().prevUntil().show(),this.collection.renderTop()}getDivForLine(t,e){const[s,a,i]=this.lineToParts(t),r=$("<div/>").addClass(s).attr("line-ind",e+1),c=this.textLineRender(i,s),l=$("<i/>").addClass("far fa-share share-icon action-icon");if(o.has(s)){a&&$("<span/>").addClass("titnum").text(a+".").appendTo(r);const t=n.bookmarks.getIcon(this.fileId,e+1);r.attr("tt",o.get(s)).append(c,l,t)}else a?$("<span/>").addClass(`hangnum ${a.length>4?"long":""}`).text(a+".").append(l).appendTo(r):$.inArray(s,["bod","gax","gae"])>=0&&$("<span/>").addClass("hangnum").appendTo(r),r.append(c).hide();return r}lineToParts(t){const e=t.split(":");return t&&(e.length<2||e.length>3)&&console.log(`malformed line ${t} in file ${this.fileId}`),[e[0],e.length>2?e[1]:"",e[e.length-1]]}textLineRender(t,e=""){t=a.TextProcessor.beautify(t,this.script,e);const s=$("<span/>").addClass("line-text").html(t);return r.Note.render(s),r.PageTag.render(s),s}}},function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.FTSHandler=void 0;var a=s(0),i=s(1),r=s(3),n=s(4);const o=!1,c=["1","abcde","2","3","fghij","4","5","klmno","6","pqrstuvwxy"];e.FTSHandler=class{constructor(){this.prevTerms=[],this.matchesStore=null,this.settings={minQueryLength:3,maxMatches:100,maxFiles:100,searchDelay:400},this.requestTimer="",this.options={exactWord:!0,exactPhrase:!0,matchOrder:!0,wordDistance:10,maxMatches:this.settings.maxMatches,maxFiles:this.settings.maxFiles}}init(t,e){this.appTree=t,this.appTabs=e,this.filterParents=a.appSettings.get("fts-search-filter"),this.filterParents||(this.filterParents=n.TSH.topParentsInfo.slice(0,-1).map(t=>t[0]),a.appSettings.set("fts-search-filter",this.filterParents)),this.filter=new n.SearchFilter($("#fts-filter"),n.TSH.topParentsInfo,this.filterParents,this),this.registerClicks()}registerClicks(){$(".option[hide=exactPhrase]").toggleClass("hidden",this.options.exactPhrase),$("#fts-options").on("click",".check-box",t=>{const e=$(t.currentTarget).toggleClass("checked");this.options[e.attr("param")]=e.hasClass("checked"),$(".option[hide=exactPhrase]").toggleClass("hidden",this.options.exactPhrase),this.scheduleSearchIndex()}),$("#input-word-distance").change(()=>{const t=Number($("#input-word-distance").val());t<=0||t>=100?this.setStatus((0,a.UT)("fts-range-word-distance")):(this.options.wordDistance=t,this.scheduleSearchIndex())}),$("#fts-filter-button").click(t=>$("#fts-filter").slideToggle("fast")),$("#fts-match-list").on("click",".search-result",t=>{this.displayInfo($(t.currentTarget).attr("matchInd"))}),$("#fts-match-info").on("click","i.name",t=>this.openResult(t))}performSearch(t){const e=t.replace(/\s+/g," ").replace(/[\d\,!;"‚Äò‚Äô‚Äú‚Äù‚Äì<>=\:]/g,"");if(e.length<this.settings.minQueryLength)return void this.setStatus((0,a.UT)("enter-more-characters",this.settings.minQueryLength));const s=i.TextProcessor.convertFromMixed(e).split(" ");this.checkTerms(s)&&(s.length==this.prevTerms.length&&s.every((t,e)=>this.prevTerms[e]==t)||(this.prevTerms=s,this.scheduleSearchIndex()))}checkTerms(t){return!!(t&&t.length&&t.every(t=>/[‡∂Ö-‡∑Ü]/.exec(t)))||(this.setStatus((0,a.UT)("fts-search-term-one-char")),!1)}scheduleSearchIndex(){this.requestTimer&&clearTimeout(this.requestTimer),this.requestTimer=setTimeout(()=>this.searchIndex(),this.settings.searchDelay)}searchIndex(){if(!this.checkTerms(this.prevTerms))return;$("#fts-match-list,#fts-match-info").empty();const t={type:"get-matches",terms:this.prevTerms,params:this.getQueryParams()},e=o?new FTSQuery(t):new h(t);console.log(`sending query with terms ${this.prevTerms} and params ${JSON.stringify(e.params)}`),this.setBusySearching(!0),e.send().then(t=>{this.matchesStore=t,console.log(`received mstore with ${t.matches.length} matches and ${Object.keys(t.wordInfo).length} words`),this.setBusySearching(!1),this.displayMatches()}).catch(t=>{this.setBusySearching(!1),this.setStatus((0,a.UT)(t.message)),console.error(t)})}getQueryParams(){const t=this.options;if(n.TSH.topParentsInfo.length!=this.filterParents.length){const e=[];n.TSH.topParentsInfo.forEach((t,s)=>{this.filterParents.indexOf(t[0])>=0&&e.push(c[s])}),t.filter=e}else t.filter=null;return t}setBusySearching(t){$("#fts-area").toggleClass("busy-searching",t)}displayMatches(){0!=this.matchesStore.matches.length?($("#fts-match-list").append(this.matchesStore.matches.map(([t,e,s,i],r)=>{const n=$("<div/>").addClass("search-result").attr("matchInd",r);return t.forEach(t=>{(0,a.PT)(this.matchesStore.wordInfo[t][0]).addClass("token").appendTo(n)}),$("<span/>").text(e).addClass("total-freq").appendTo(n),$("<span/>").text(i).addClass("count-files").appendTo(n),n})),this.matchesStore.matches.length<this.settings.maxMatches?this.setStatus((0,a.UT)("number-of-results-found",this.matchesStore.matches.length)):this.setStatus((0,a.UT)("fts-too-many-results-found",this.matchesStore.stats.considered,this.settings.maxMatches)),this.displayInfo(0)):this.setStatus((0,a.UT)("no-results-found",this.prevTerms.join(" ")))}displayInfo(t){$("#fts-match-list").children().removeClass("selected").filter(`[matchInd=${t}]`).addClass("selected");const e=this.matchesStore.matches[t];$("#fts-match-info").empty().append(e[2].map(([t,e,s],i)=>{const r=$("<div/>").addClass("search-result").attr("file",t).attr("fileInd",i),o=n.TSH.data[n.TSH.fileToTSI.get(t)];return o[n.TSE.parents].forEach(t=>{(0,a.PT)(n.TSH.data[t][n.TSE.name]).addClass("parent name").attr("index",t).appendTo(r),$("<i/>").text(" ¬ª ").appendTo(r)}),(0,a.PT)(o[n.TSE.name]).addClass("child name").attr("index",o[n.TSE.id]).appendTo(r),$("<span/>").text(s).addClass("count-files").appendTo(r),r})).attr("matchInd",t)}openResult(t){const e=$(t.currentTarget),s=n.TSH.data[e.attr("index")][n.TSE.file];if(e.parent().attr("file")!=s)return;const a=this.appTree.getCollection(s),i=r.PitakaTree.filterCollection(a,s),o=e.parents("[matchInd]").first().attr("matchInd"),c=this.matchesStore.matches[o],l=c[0].map(t=>this.matchesStore.wordInfo[t][0]),h=e.parent().attr("fileInd"),d=c[2][h][1];this.appTabs.newTab(s,i[1],a,{words:l,offsets:d}),this.appTree.openBranch(s)}filterChanged(t){this.filterParents=t,a.appSettings.set("fts-search-filter",this.filterParents),console.log(`fts filter changing to ${this.filterParents}`),this.scheduleSearchIndex()}setStatus(t){$("#fts-status",this.root).empty().append(t)}changeScript(){(0,a.PT_REFRESH)($("#fts-area"))}async checkInit(){o&&await new FTSQuery("init-data").send()}};const l="https://tipitaka.app/nodejs/fts-query/";class h{constructor(t){this.type=t.type,this.terms=t.terms,this.params=t.params}async send(){const t={type:this.type,terms:this.terms,params:this.params},e=await $.post(l,JSON.stringify(t));if(e.error)throw new Error(e.error);return e}}}]);