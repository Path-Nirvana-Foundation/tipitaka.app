!function(t){var e={};function n(a){if(e[a])return e[a].exports;var r=e[a]={i:a,l:!1,exports:{}};return t[a].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=t,n.c=e,n.d=function(t,e,a){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:a})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(n.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)n.d(a,r,function(e){return t[e]}.bind(null,r));return a},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=3)}([function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.appSettings=e.LangHelper=void 0;var a=function(){function t(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(e,n,a){return n&&t(e.prototype,n),a&&t(e,a),e}}(),r=n(1);function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var o=Object.freeze({SI:"si",EN:"en"}),s=new Map([[o.SI,["සිංහල","sl_flag.png"]],[o.EN,["English","uk_flag.png"]]]),l=new Map([["none",["Do Not Show",""]],["click",["Show On Click",'<n><i class="far fa-asterisk"></i></n>']],["inline",["Show Inline","<n>[…]</n>"]]]),c=new Map([["none",["Do Not Show",""]],["click",["Show On Click",'<pd class="T">¶</pd>']],["short",["Short Name",'<pd class="T">[T 1.34]</pd>']],["full",["Full Name",'<pd class="T">[Thai 3.41]</pd>']]]),u=new Map([["12",["Smallest",'<i style="font-size: 12px">Aa</i>']],["14",["Smaller",'<i style="font-size: 14px">Aa</i>']],["16",["Medium",'<i style="font-size: 16px">Aa</i>']],["18",["Larger",'<i style="font-size: 18px">Aa</i>']],["20",["Largest",'<i style="font-size: 20px">Aa</i>']]]),p=function(){function t(){i(this,t),this.uiLanguage=o.EN,this.paliScript=r.Script.SI,this.abbreFormat="inline",this.pageTagFormat="click",this.textSize="16",this.savedLocations=[],this.paliScriptList=r.paliScriptInfo,this.uiLanguageList=s,this.abbreFormatList=l,this.pageTagFormatList=c,this.textSizeList=u}return a(t,[{key:"initialize",value:function(){return!!this.loadFromStorage()||this.loadDefaults()}},{key:"loadFromStorage",value:function(){}},{key:"saveToStorage",value:function(){}},{key:"loadDefaults",value:function(){}}]),t}();e.LangHelper=function(){function t(){i(this,t)}return a(t,null,[{key:"extractLanguageStrings",value:function(e){t.loadTranslation(e).then(function(){var t=new Map(data_trans);$("i.UT").each(function(e,n){var a=$(n).attr("lang")==o.EN?$(n).text().trim():$(n).attr("en-text");t.has(a)||t.set(a,"")});var e=[];t.forEach(function(t,n){return e.push(n,t)}),console.log(e.join("\r\n"))})}},{key:"loadTranslation",value:function(t){var e="./scripts/translations/"+t+"_trans.js";return $.getScript(e,function(t,n,a){console.log("Translation script with data length "+t.length+" was loaded from file "+e+". \n                Status '"+n+":"+a.status)})}},{key:"changeTranslation",value:function(e){console.log("changing UI language to "+e),e!=o.EN?t.loadTranslation(e).then(function(){var t=new Map(data_trans);$("i.UT").each(function(n,a){var r=$(a).attr("lang")==o.EN?$(a).text().trim():$(a).attr("en-text");r||console.error("UT found with empty en-text "+$(a)),t.has(r)&&$(a).attr("en-text",r).attr("lang",e).text(t.get(r))}).attr("lang",e)}):$("i.UT").each(function(t,e){return $(e).text($(e).attr("en-text")||$(e).text().trim())}).attr("lang",e)}}]),t}(),e.appSettings=new p},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a,r,i,o,s=function(){function t(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(e,n,a){return n&&t(e.prototype,n),a&&t(e,a),e}}();function l(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var c=e.Script=Object.freeze({SI:"si",HI:"hi",RO:"ro",THAI:"th",LAOS:"lo",MY:"my",KM:"km"}),u=(e.paliScriptInfo=new Map([[c.SI,["Sinhala","සිංහල","sl_flag.png"]],[c.HI,["Devanagari","हिन्दी","in_flag.png"]],[c.RO,["Roman","Roman","uk_flag.png"]],[c.THAI,["Thai","ภาษาไทย","th_flag.png"]],[c.LAOS,["Laos","ພາສາລາວ","laos_flag.png"]],[c.MY,["Myanmar","ဗမာစာ","my_flag.png"]],[c.KM,["Khmer","ភាសាខ្មែរ","kh_flag.png"]]]),l(a={},c.SI,0),l(a,c.HI,1),l(a,c.RO,2),l(a,c.THAI,3),l(a,c.LAOS,4),l(a,c.MY,5),l(a,c.KM,6),a),p=[["අ","अ","a","อ","ອ","အ","អ"],["ආ","आ","ā","อา","ອາ","အာ","អា"],["ඉ","इ","i","อิ","ອິ","ဣ","ឥ"],["ඊ","ई","ī","อี","ອີ","ဤ","ឦ"],["උ","उ","u","อุ","ອຸ","ဥ","ឧ"],["ඌ","ऊ","ū","อู","ອູ","ဦ","ឩ"],["එ","ए","e","เอ","ເອ","ဧ","ឯ"],["ඔ","ओ","o","โอ","ໂອ","ဩ","ឱ"],["ං","ं","ṃ","ํ","ໍ","ံ","ំ"],["ඃ","ः","ḥ","","","း","ះ"],["්","्","","ฺ","຺","္","្"],["0","०","0","๐","໐","၀","០"],["1","१","1","๑","໑","၁","១"],["2","२","2","๒","໒","၂","២"],["3","३","3","๓","໓","၃","៣"],["4","४","4","๔","໔","၄","៤"],["5","५","5","๕","໕","၅","៥"],["6","६","6","๖","໖","၆","៦"],["7","७","7","๗","໗","၇","៧"],["8","८","8","๘","໘","၈","៨"],["9","९","9","๙","໙","၉","៩"]],f=[["ක","क","k","ก","ກ","က","ក"],["ඛ","ख","kh","ข","ຂ","ခ","ខ"],["ග","ग","g","ค","ຄ","ဂ","គ"],["ඝ","घ","gh","ฆ","ຆ","ဃ","ឃ"],["ඞ","ङ","ṅ","ง","ງ","င","ង"],["ච","च","c","จ","ຈ","စ","ច"],["ඡ","छ","ch","ฉ","ຉ","ဆ","ឆ"],["ජ","ज","j","ช","ຊ","ဇ","ជ"],["ඣ","झ","jh","ฌ","ຌ","ဈ","ឈ"],["ඤ","ञ","ñ","ญ","ຎ","ဉ","ញ"],["ට","ट","ṭ","ฏ","ຏ","ဋ","ដ"],["ඨ","ठ","ṭh","ฐ","ຐ","ဌ","ឋ"],["ඩ","ड","ḍ","ฑ","ຑ","ဍ","ឌ"],["ඪ","ढ","ḍh","ฒ","ຒ","ဎ","ឍ"],["ණ","ण","ṇ","ณ","ຓ","ဏ","ណ"],["ත","त","t","ต","ຕ","တ","ត"],["ථ","थ","th","ถ","ຖ","ထ","ថ"],["ද","द","d","ท","ທ","ဒ","ទ"],["ධ","ध","dh","ธ","ຘ","ဓ","ធ"],["න","न","n","น","ນ","န","ន"],["ප","प","p","ป","ປ","ပ","ប"],["ඵ","फ","ph","ผ","ຜ","ဖ","ផ"],["බ","ब","b","พ","ພ","ဗ","ព"],["භ","भ","bh","ภ","ຠ","ဘ","ភ"],["ම","म","m","ม","ມ","မ","ម"],["ය","य","y","ย","ຍ","ယ","យ"],["ර","र","r","ร","ຣ","ဟ","រ"],["ල","ल","l","ล","ລ","သ","ល"],["ව","व","v","ว","ວ","ဝ","វ"],["ස","स","s","ส","ສ","လ","ស"],["හ","ह","h","ห","ຫ","ရ","ហ"],["ළ","ळ","ḷ","ฬ","ຬ","ဠ","ឡ"]],h=[["ා","ा","ā","า","າ","ာ","ា"],["ි","ि","i","ิ","ິ","ိ","ិ"],["ී","ी","ī","ี","ີ","ီ","ី"],["ු","ु","u","ุ","ຸ","ု","ុ"],["ූ","ू","ū","ู","ູ","ူ","ូ"],["ෙ","े","e","เ","ເ","ေ","េ"],["ො","ो","o","โ","ໂ","ော","ោ"]];function d(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return"cen"==n?t=t.replace("॥",""):n.startsWith("ga")&&(t=(t=t.replace("।",";")).replace("॥",".")),t=(t=(t=(t=t.replace("॰…","…")).replace(/\u0970/g,"·")).replace(/[\u0964\u0965]/g,".")).replace(/\s([\s,!;\?\.])/g,"$1")}function g(t,e){arguments.length>2&&void 0!==arguments[2]&&arguments[2];return e==c.THAI?t.replace(/([ก-ฮ])([เโ])/g,"$2$1"):e==c.LAOS?t.replace(/([ກ-ຮ])([ເໂ])/g,"$2$1"):void console.error("Unsupported script "+e+" for swap_e_o method.")}var v=(l(r={},c.SI,[function(t,e){return arguments.length>2&&void 0!==arguments[2]&&arguments[2],t.replace(/\u0DCA([\u0DBA\u0DBB])/g,"්‍$1")},d]),l(r,c.HI,[]),l(r,c.RO,[d,function(t,e){return arguments.length>2&&void 0!==arguments[2]&&arguments[2],(t=(t=t.replace(/^(\S)/g,function(t,e){return e.toUpperCase()})).replace(/([\.\?]\s)(\S)/g,function(t,e,n){return""+e+n.toUpperCase()})).replace(/([\u201C‘])(\S)/g,function(t,e,n){return""+e+n.toUpperCase()})}]),l(r,c.THAI,[g,d]),l(r,c.LAOS,[g,d]),l(r,c.MY,[d]),l(r,c.KM,[d]),r);function b(t,e){var n=[];return f.concat(p,h).forEach(function(a){a[t]&&n.push([a[t],a[e]])}),new Map(n)}function y(t,e){t=function(t){return t.replace(/\u200C|\u200D/g,"")}(t);for(var n="",a=new Array(t.length),r=0;r<t.length;r++)n=t.charAt(r),e.has(n)?a[r]=e.get(n):a[r]=n;return a.join("")}var T=(l(i={},c.SI,[]),l(i,c.HI,[m]),l(i,c.RO,[function(t,e){return(e=(e=e.replace(/([ක-ෆ])([^\u0DCF-\u0DDF\u0DCAa])/g,"$1a$2")).replace(/([ක-ෆ])([^\u0DCF-\u0DDF\u0DCAa])/g,"$1a$2")).replace(/([ක-ෆ])$/g,"$1a")},m]),l(i,c.THAI,[m]),l(i,c.LAOS,[m]),l(i,c.MY,[m]),l(i,c.KM,[m]),i),S=(l(o={},c.SI,[]),l(o,c.HI,[function(t,e){var n=b(u[t],u[c.SI]);return y(e,n)}]),o);function m(t,e){return y(e,b(u[c.SI],u[t]))}var k=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}return s(t,null,[{key:"basicConvert",value:function(t,e){return T[e].forEach(function(n){return t=n(e,t)}),t}},{key:"basicConvertFrom",value:function(t,e){return S[e].forEach(function(n){return t=n(e,t)}),t}},{key:"beautify",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return v[e].forEach(function(a){return t=a(t,e,n)}),t}},{key:"convert",value:function(t,e){return t=this.basicConvert(t,e),this.beautify(t,e)}}]),t}();e.TextProcessor=k},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.FileDisplay=void 0;var a=function(){return function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,e){var n=[],a=!0,r=!1,i=void 0;try{for(var o,s=t[Symbol.iterator]();!(a=(o=s.next()).done)&&(n.push(o.value),!e||n.length!==e);a=!0);}catch(t){r=!0,i=t}finally{try{!a&&s.return&&s.return()}finally{if(r)throw i}}return n}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),r=function(){function t(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(e,n,a){return n&&t(e.prototype,n),a&&t(e,a),e}}();e.PT=function(t){return $("<i/>").addClass("PT").attr("si-text",t).attr("lang",o.appSettings.paliScript).text(i.TextProcessor.convert(t,o.appSettings.paliScript))},e.PT_REFRESH=function(t){$("i.PT",t).each(function(t,e){var n=$(e).attr("si-text");n=i.TextProcessor.convert(n,o.appSettings.paliScript),$(e).text(n).attr("lang",o.appSettings.paliScript)})};var i=n(1),o=n(0),s=n(5);var l=new Map([["cha","1-2-3"],["tit","1-2"],["sub","1"]]);e.FileDisplay=function(){function t(e,n,a,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.root=e,this.fileId=n,this.collection=new s.Collection(a,this.root,this.fileId,r),this.data="",this.script=o.appSettings.paliScript,this.registerClicks()}return r(t,[{key:"load",value:function(){var t=this,e=new XMLHttpRequest;e.open("GET","../static/text/"+this.fileId+".txt",!0),e.responseType="arraybuffer",e.onload=function(n){t.data=function(t){for(var e=[],n=0;n<t.length;n+=32768)e.push(String.fromCharCode.apply(null,t.subarray(n,n+32768)));return e.join("")}(new Uint16Array(e.response)),t.refresh()},e.send()}},{key:"registerClicks",value:function(){var t=this;this.root.on("click","n.click",function(t){return s.Note.showNoteBox(t)}).on("click","[tt] .line-text",function(e){var n=$(e.currentTarget).parent(),a=n.toggleClass("open").nextUntil("[tt|="+n.attr("tt")+"]");a.filter(":not([tt])").toggle(n.hasClass("open")),a.filter("[tt]").toggleClass("open",n.hasClass("open")),t.root.parent().scrollTop(t.root.parent().scrollTop()+n.position().top)}).on("click",".hangnum,.titnum",function(e){return t.collection.renderOnClick(e)})}},{key:"changeScript",value:function(){this.script!=o.appSettings.paliScript&&(this.script=o.appSettings.paliScript,this.refresh())}},{key:"refresh",value:function(){var t=this;this.root.empty().attr("lang",this.script),i.TextProcessor.basicConvert(this.data,this.script).split("\r\n").forEach(function(e,n){t.root.append(t.getDivForLine(e,n))}),1==this.root.find("[tt]").length&&this.root.find("[tt]").children(".line-text").click(),this.root.children(".cha").first().prevUntil().show()}},{key:"getDivForLine",value:function(t,e){var n=this.lineToParts(t),r=a(n,3),i=r[0],o=r[1],s=r[2],c=$("<div/>").addClass(i).attr("line-ind",e),u=this.textLineRender(s,i),p=$("<i/>").addClass("far fa-share share-icon action-icon");if(l.has(i)){o&&$("<span/>").addClass("titnum").text(o+".").appendTo(c);var f=$("<i/>").addClass("far fa-star save-icon action-icon");c.attr("tt",l.get(i)).append(u,p,f)}else o&&$("<span/>").addClass("hangnum "+(o.length>4?"long":"")).text(o+".").append(p).appendTo(c),c.append(u).hide();return c}},{key:"lineToParts",value:function(t){var e=t.split(":");return t&&(e.length<2||e.length>3)&&console.log("malformed line "+t+" in file "+this.fileId),[e[0],e.length>2?e[1]:"",e[e.length-1]]}},{key:"textLineRender",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";t=i.TextProcessor.beautify(t,this.script,e);var n=$("<span/>").addClass("line-text").html(t);return s.Note.render(n),s.PageTag.render(n),n}}]),t}()},function(t,e,n){"use strict";var a=n(0),r=n(4),i=new(n(6).PitakaTree)($(".pitaka-tree")),o=new r.PitakaTabs($(".text-section"),i);function s(t,e,n){var a=$("<span/>").addClass("UT").text(e).attr("lang",t),r=$("<img/>").attr("src","./static/images/"+n);return $("<div/>").addClass("option").append(a,r).attr("value",t)}i.initialize(o).done(function(){console.log("tree loaded")});var l=$("#pali-script-select");function c(t,e,n,r){t.forEach(function(t,n){var a=$("<span/>").append($("<i/>").addClass("UT").attr("lang","en").text(t[0])),r=$(t[1]).addClass("example");$("<div/>").addClass("option").append(a,r).attr("value",n).appendTo(e)}),e.on("click",".option",function(t){var e=a.appSettings[n]=$(t.currentTarget).attr("value");r(e)}).children("[value="+a.appSettings[n]+"]").addClass("active")}a.appSettings.paliScriptList.forEach(function(t,e){s(e,t[1],t[2]).appendTo(l)}),l.on("click",".option",function(t){var e=$(t.currentTarget);console.log("Pali script changing from "+a.appSettings.paliScript+" to "+e.attr("value")),a.appSettings.paliScript=e.attr("value"),i.changeScript(),o.changeScript()}).children("[value="+a.appSettings.paliScript+"]").addClass("active"),a.appSettings.uiLanguageList.forEach(function(t,e){s(e,t[0],t[1]).appendTo($("#ui-lang-select"))}),$("#ui-lang-select").on("click",".option",function(t){a.appSettings.uiLanguage=$(t.currentTarget).attr("value"),a.LangHelper.changeTranslation(a.appSettings.uiLanguage)}).children("[value="+a.appSettings.uiLanguage+"]").addClass("active"),c(a.appSettings.abbreFormatList,$("#abbre-format-select"),"abbreFormat",o.changeTextFormat.bind(o)),c(a.appSettings.pageTagFormatList,$("#pagetag-format-select"),"pageTagFormat",o.changeTextFormat.bind(o)),c(a.appSettings.textSizeList,$("#text-size-select"),"textSize",function(t){$("html").css("font-size",t+"px")}),$(".custom-radio").on("click",".option",function(t){$(t.currentTarget).addClass("active").siblings().removeClass("active"),o.getNumTabs()&&showPane("text")}),$("#settings-button").click(function(t){return showPane("settings")}),$("#text-view-button").click(function(t){return showPane("text")}),$(".search-bar").focus(function(t){return showPane("search")}),$("#menu-toggle").mousedown(function(t){$("#menu-list").animate({height:"toggle"},200),t.stopPropagation()}),$("#tree-toggle").mousedown(function(t){$(".pitaka-tree-container").animate({width:"toggle"},250),$(".pitaka-tree-container").toggleClass("user-opened"),t.stopPropagation()}),$("#menu-list, .pitaka-tree-container").mousedown(function(t){t.stopPropagation()}),$("body").mousedown(function(){$("#menu-list").animate({height:"hide"},350),"absolute"==$(".pitaka-tree-container").css("position")&&$(".pitaka-tree-container").animate({width:"hide"},250)}),$("span.sort-action").on("click","a",function(){var t=$(this).parent().attr("by"),e=$(this).attr("order");refreshCurrentSearchDisplay(t,e)})},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.PitakaTabs=void 0;var a=function(){function t(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(e,n,a){return n&&t(e.prototype,n),a&&t(e,a),e}}(),r=n(2);e.PitakaTabs=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.root=e,this.appTree=n,this.tabs=new Map,this.files=new Map,this.activeFileId="",this.heads=$("div.tab-heads",this.root),this.contents=$("div.tab-contents",this.root),this.registerClicks()}return a(t,[{key:"registerClicks",value:function(){var t=this;this.heads.on("click",".tab-head",function(e){t.showTab($(e.currentTarget).attr("file-id"))}),this.heads.on("click",".close-icon",function(e){t.removeTab($(e.currentTarget).parent().attr("file-id")),e.stopPropagation()})}},{key:"showTab",value:function(t){if(!this.tabs.has(t))return!1;this.tabs.forEach(function(t){return t.forEach(function(t){return t.removeClass("active")})}),this.tabs.get(t).forEach(function(t){return t.addClass("active")}),this.activeFileId=t}},{key:"removeTab",value:function(t){if(!this.tabs.has(t)||this.tabs.size<=1)return!1;this.tabs.get(t).forEach(function(t){return t.remove()}),this.tabs.delete(t),this.files.delete(t),this.activeFileId==t&&this.showTab(this.tabs.keys().next().value)}},{key:"newTab",value:function(e,n,a){if(this.tabs.has(e))return this.showTab(e);console.log(this);var i=(0,r.PT)(n.replace(/^[\(\)\d+\s\.]+/,"")),o=$("<span/>").append(i).addClass("head-label"),s=$("<span/>").addClass("close-icon far fa-times"),l=t.getCollIcon(e,a),c=$("<div/>").addClass("tab-head").append(l,o,s).attr("file-id",e).appendTo(this.heads),u=$("<div/>").addClass("tab-content").attr("file-id",e).appendTo(this.contents),p=new r.FileDisplay(u,e,a,this);p.load(),this.tabs.set(e,[c,u]),this.files.set(e,p),this.showTab(e)}},{key:"changeScript",value:function(){if(0!=this.tabs.size){var t=this.tabs.get(this.activeFileId)[0];(0,r.PT_REFRESH)(t),this.files.get(this.activeFileId).changeScript()}}},{key:"changeTextFormat",value:function(){this.files.forEach(function(t){return t.refresh()})}},{key:"getNumTabs",value:function(){return this.tabs.size}}],[{key:"getCollIcon",value:function(t,e){var n=e.n.find(function(e){return e[2]==t})[0].charAt(0).toUpperCase();return $("<span/>").addClass(n).addClass("coll-icon").text(n)}}]),t}()},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Collection=e.Note=e.PageTag=void 0;var a=function(){function t(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(e,n,a){return n&&t(e.prototype,n),a&&t(e,a),e}}(),r=n(0);function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var o=new Map([["T","Thai"],["M","Myanmar"],["V","VRI"],["P","PTS"]]),s=function(t){return t.replace(new RegExp("^[0०๐໐၀០]+","g"),"")};e.PageTag=function(){function t(){i(this,t)}return a(t,null,[{key:"render",value:function(e){"none"==r.appSettings.pageTagFormat?e.children("pd").remove():e.children("pd").each(function(e,n){return t.getPageTagDisplay($(n))})}},{key:"getPageTagDisplay",value:function(t){var e=void 0,n=void 0,a=!0,i=!1,l=void 0;try{for(var c,u=o[Symbol.iterator]();!(a=(c=u.next()).done);a=!0){var p=c.value;if(n=t.attr(p[0])){e=p;break}}}catch(t){i=!0,l=t}finally{try{!a&&u.return&&u.return()}finally{if(i)throw l}}var f=function(t){return-1!="0०๐໐၀០".indexOf(t)}((n=n.split("."))[0])?"":n[0]+".";"click"==r.appSettings.pageTagFormat?t.text("¶").addClass("click"):"short"==r.appSettings.pageTagFormat?t.text("["+e[0]+": "+f+s(n[1])+"]"):t.html("[<i>"+e[1]+"</i> "+f+s(n[1])+"]"),t.addClass(e[0])}}]),t}(),e.Note=function(){function t(){i(this,t)}return a(t,null,[{key:"render",value:function(t){"none"==r.appSettings.abbreFormat?t.children("n").remove():"click"==r.appSettings.abbreFormat?t.children("n").each(function(t,e){$(e).attr("text",$(e).text()).empty().addClass("click")}):t.children("n").each(function(t,e){return $(e).text("["+$(e).text()+"]")})}},{key:"showNoteBox",value:function(t){var e=$(t.currentTarget);alert(e.attr("text"))}}]),t}(),e.Collection=function(){function t(e,n,a,r){i(this,t),this.collObj=e,this.root=n,this.fileId=a,this.tabs=r,this.renderTop(),this.registerClicks()}return a(t,[{key:"registerClicks",value:function(){var t=this;this.root.on("click",".coll-button",function(e){var n=$(e.currentTarget).attr("na"),a=t.collObj.n.filter(function(t){return t[0]==n})[0];console.log(a),t.tabs.newTab(a[2],a[1],t.collObj)}).parent().scroll(function(e){t.buttons.css("top",t.root.parent().scrollTop()+10)})}},{key:"renderTop",value:function(){var t=this;this.buttons=$("<div/>").addClass("coll-buttons top").appendTo(this.root),this.collObj.n.filter(function(e){return e[2]!=t.fileId}).forEach(function(e){var n=e[0].toUpperCase();$("<span/>").addClass(["coll-button",n.charAt(0)]).text(n).attr("na",n.toLowerCase()).appendTo(t.buttons)})}},{key:"renderOnClick",value:function(){}}]),t}()},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.PitakaTree=void 0;var a=function(){function t(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(e,n,a){return n&&t(e.prototype,n),a&&t(e,a),e}}(),r=n(2);n(0);var i=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.root=e,this.treeJson={},this.collections=[],this.fileIdToColl={}}return a(t,[{key:"initialize",value:function(t){var e=this;return this.appTabs=t,$.getJSON("../static/json/full-tree.json",function(t){e.treeJson=t,e.createCollections(e.treeJson,-1),e.root.append(e.createSubtree(e.treeJson,["m"],"tree-mul")),e.root.append(e.createSubtree(e.treeJson,["a"],"tree-att")),e.root.append(e.createSubtree(e.treeJson,["t","ta"],"tree-tik")),e.root.append(e.createSubtree(e.treeJson[3].c,["e"],"tree-e")),e.registerClick(),console.log("Tree loaded. num collections: "+e.collections.length+", num fileIds: "+Object.keys(e.fileIdToColl).length)}).fail(function(t,e,n){console.error("getJSON failed, status: "+e+", error: "+n)})}},{key:"createSubtree",value:function(t,e,n,a){var i=this,o=$("<ul/>").attr("id",n);return t.forEach(function(t){if(t.c){var n=!0,s=!1,l=void 0;try{for(var c,u=e[Symbol.iterator]();!(n=(c=u.next()).done);n=!0){var p=c.value;if(t[p]){var f=$("<a/>").append((0,r.PT)(t[p]));$("<li/>").append(f).addClass("parent").append(i.createSubtree(t.c,e,"",p)).appendTo(o)}}}catch(t){s=!0,l=t}finally{try{!n&&u.return&&u.return()}finally{if(s)throw l}}}else if(t["f"+a]){var h=$("<a/>").append((0,r.PT)(t[a])),d=t["f"+a];$("<li/>").append(h).attr("file-id",d).appendTo(o)}}),o}},{key:"addCollection",value:function(t,e){var n=this,a=this.collections.length,r={id:a,p:e,n:[]};return Object.keys(t).forEach(function(e){if("c"!=e&&!e.startsWith("f")){var i=t["f"+e];i?(r.n.push([e,t[e],i]),n.fileIdToColl[i]=a):r.n.push([e,t[e]])}}),this.collections.push(r),a}},{key:"createCollections",value:function(t,e){var n=this;t.forEach(function(t){t.c?n.createCollections(t.c,n.addCollection(t,e)):n.addCollection(t,e)})}},{key:"changeScript",value:function(){(0,r.PT_REFRESH)(this.root)}},{key:"registerClick",value:function(){var t=this;console.log("reg"),this.root.on("click","li > a",function(e){var n=$(e.currentTarget).parent();if(n.hasClass("parent"))t.toggleBranch(n);else if(n.attr("file-id")){var a=n.find(".PT").attr("si-text"),r=n.attr("file-id");t.appTabs.newTab(r,a,t.collections[t.fileIdToColl[r]]),showPane("text")}})}},{key:"toggleBranch",value:function(t){t.toggleClass("active").children("ul").slideToggle("fast")}},{key:"showBranch",value:function(t){t.addClass("active").children("ul").slideDown("fast")}},{key:"collapse",value:function(){$("li.parent",this.root).removeClass("active")}},{key:"openBranch",value:function(t){var e=this,n=$("li[file-id="+t+"]",this.root);console.log(n.length),n.parents("li").each(function(t){return e.showBranch($(t))}),console.log(n.parents("li"))}}]),t}();e.PitakaTree=i}]);